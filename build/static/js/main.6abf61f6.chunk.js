(this["webpackJsonptravelling-admin"]=this["webpackJsonptravelling-admin"]||[]).push([[0],{365:function(e,t,a){e.exports=a.p+"static/media/selectedTourIcon.127fd3ea.svg"},442:function(e,t,a){e.exports=a(726)},713:function(e,t,a){e.exports=a.p+"static/media/selectedParking.102bdd14.svg"},714:function(e,t,a){e.exports=a.p+"static/media/availableParking.6ac3f9ec.svg"},726:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(23),i=a.n(l),o=a(370),c=a(371),s=a(414),u=a(413),d=a(14),m=a(4),p=a(6),f=a(2),g=a(102),b=a(37),h=a(823),E=a(807),v=a(808),y=a(779),O=a(781),j=a(63),C=a(802),S=a(419),k=a(266),I=a.n(k),x=a(408),w=a.n(x),P=a(409),T=a.n(P),A=a(786),D=a(801),N=a(75),R=a(34),L=a(5),M=Object(L.a)((function(e){return{button:{margin:e.spacing(1)},input:{display:"none"}}}))((function(e){e.classes;return r.a.createElement("div",null)})),_=a(12),F=a(784),H=a(785),q=a(778),W=a(783),B=a(776),U=a(816),z=a(777),G=a(160),Y=a(72),V=a.n(Y),K=a(263),$=a.n(K),J=a(780);var Z=a(782);function X(e){var t=e.headCells;return r.a.createElement(B.a,null,r.a.createElement(z.a,null,t.map((function(e){return r.a.createElement(q.a,{key:e.id,align:e.numeric?"right":"left",padding:"default"},e.label)}))))}var Q=Object(g.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(_.e)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),ee=function(e){var t=Q(),a=e.title,l=e.changePageCallback,i=e.keyword,o=e.setKeyword,c=e.customToolbarElements,s=function(e,t){var a=Object(n.useState)(e),r=Object(m.a)(a,2),l=r[0],i=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){i(e)}),t);return function(){clearTimeout(a)}}),[e]),l}(i,300);return Object(n.useEffect)((function(){l(1,i)}),[s]),r.a.createElement(y.a,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},r.a.createElement("div",null,void 0!==c?c:null),r.a.createElement("div",{style:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"}},r.a.createElement(j.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div"},a),r.a.createElement(J.a,{id:"standard-basic",label:"Search",value:i,onChange:function(e){o(e.target.value)}}))))},te=Object(g.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},centerCell:{textAlign:"center",width:"100%"},rowNotPublished:{backgroundColor:"#ffcdd2"},rowNotVerified:{backgroundColor:"#fff9c4"},rowBasic:{backgroundColor:"#FFFFFF"}}}));function ae(e){var t=e.title,a=e.searchFunction,l=e.headCells,i=e.pagingInfo,o=e.data,c=e.changePageCallback,s=e.updateCallback,u=e.removeCallback,d=e.id,p=e.isLoading,f=e.customToolbarElements,g=e.initialKeyword;ae.defaultProps={initialKeyword:""};var b=te(),h=Object(n.useState)(0),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)(g),C=Object(m.a)(O,2),k=C[0],I=C[1],x=10-Math.min(10,o.length-10*v);return r.a.createElement("div",{className:b.root},r.a.createElement(G.a,{className:b.paper},r.a.createElement("div",{style:{height:8}},p?r.a.createElement(Z.a,null):null),r.a.createElement(ee,{title:t,changePageCallback:c,keyword:k,setKeyword:I,customToolbarElements:f}),r.a.createElement(W.a,null,r.a.createElement(F.a,{className:b.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table"},r.a.createElement(X,{headCells:l}),r.a.createElement(H.a,null,o.filter((function(e){return void 0===a||a(k,e)})).slice(10*v,10*v+10).map((function(e,t){var a="enhanced-table-checkbox-".concat(t),n=void 0!==e.isVerified&&!1===e.isVerified?b.rowNotVerified:void 0!==e.isPublic&&!1===e.isPublic?b.rowNotPublished:b.rowBasic;return r.a.createElement(z.a,{className:n,hover:!0,onClick:function(t){return a=e[d],void(void 0!==s&&s(a));var a},role:"checkbox",tabIndex:-1,key:e[d]},l.map((function(t){return t.isId?r.a.createElement(q.a,{component:"th",id:a,scope:"row"},e[t.id]):"actions"===t.id?r.a.createElement(q.a,null,r.a.createElement("div",{onClick:function(e){e.stopPropagation(),e.preventDefault()}},void 0!==s?r.a.createElement(S.a,{onClick:function(t){return s(e[d]),0},size:"small","aria-label":"edit"},r.a.createElement($.a,{fontSize:"small"})):null,void 0!==u?r.a.createElement(S.a,{size:"small","aria-label":"delete",onClick:function(){return u(e[d])}},r.a.createElement(V.a,{fontSize:"small"})):null)):r.a.createElement(q.a,{align:t.numeric?"right":"left"},e[t.id])})))})),x>0&&r.a.createElement(z.a,{style:{height:53*x}},o.length>0?r.a.createElement(q.a,{colSpan:6}):!p&&r.a.createElement(q.a,{colSpan:6,className:b.centerCell},r.a.createElement(j.a,{variant:"h6",noWrap:!0},"No results")))))),r.a.createElement(U.a,{rowsPerPageOptions:[10],component:"div",count:null!==i?i.total:o.length,rowsPerPage:10,page:null!==i?i.pageNum-1:v,onChangePage:function(e,t){null!==i?c(t+1,k):y(t)}})))}var ne=a(211),re=a.n(ne),le=a(376),ie=a(267),oe=a.n(ie),ce=a(66),se=Object(ce.a)(),ue=function(){return localStorage.getItem("access_token")},de=function(){return localStorage.getItem("refresh_token")},me=function(){return!!ue()},pe=function(){var e=Object(le.a)(re.a.mark((function e(t,a){var n,r,l,i,o,c=arguments;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(c.length>2&&void 0!==c[2])||c[2],r={"Content-Type":null==a?"application/json":a,Accept:"application/json","Access-Control-Allow-Origin":"*",Authorization:"Bearer "+ue(),device:"web"},n||delete r.Authorization,(l=oe.a.create({baseURL:"https://www.traveldirection.ax.lt:8080/",headers:r})).interceptors.response.use((function(e){return e}),(function(e){var t=e.config,a=t.url,n=e.response.status;return 408===e.response.status||"ECONNABORTED"===e.code||"ERR_INTERNET_DISCONNECTED"===e.code?(console.log("A timeout happend on url ".concat(e.config.url)),Promise.reject(e)):"api/v1/auth/refresh"===a?(console.log("Asking for refresh token"),console.log("Unable to issue new JWT token. Redirecting to login page!"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),se.push("/login"),Promise.reject(e)):a.startsWith("api/v1/auth")||403!==n?Promise.reject(e):403===n&&void 0===t._retry?(console.log("Users token has expired!"),t._retry=!0,ge.Auth.refreshToken(de()).then((function(e){console.log("Retrieving new token and making the same request!");var a=e.access_token;return t.headers.Authorization="Bearer "+a,localStorage.setItem("access_token",a),oe()(t)})).catch((function(t){return Promise.reject(e)}))):Promise.reject(e)})),i=function(e){return e.data},o=function(e){return e.response?(console.debug("Status:",e.response.status),403===e.response.status&&se.push("/login"),console.debug("Data:",e.response.data),console.debug("Headers:",e.response.headers)):console.debug("Error Message:",e.message),Promise.reject(e.response.data)},e.abrupt("return",l(t).then(i).catch(o));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),fe={getRequest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return pe({url:e+t,method:"GET"})},postRequest:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return console.log("Authorize",n),pe({url:e+a,method:"POST",data:t},null,n)},postMultipartRequest:function(e,t){return pe({url:e,method:"POST",data:t},"multipart/form-data")}},ge={Explore:{getExplorePage:function(){return fe.getRequest("api/v1/explore/")},updateExplorePage:function(e){return fe.postRequest("api/v1/explore/update",e)}},Recommendation:{removeRecommendation:function(e){return fe.postRequest("api/v1/recommendation/remove",e)},updateRecommendation:function(e){return fe.postRequest("api/v1/recommendation/update",e)},removePlaceFromRecommendation:function(e){return fe.postRequest("api/v1/recommendation/removeObject",e)},addObjectToRecommendation:function(e){return fe.postRequest("api/v1/recommendation/addObject",e)},getAllRecommendations:function(e){return fe.getRequest("api/v1/recommendation/search",e)},createRecommendation:function(e){return fe.postRequest("api/v1/recommendation/create",e)}},User:{setRoles:function(e){return fe.postRequest("api/v1/user/setRoles",e)},getAllRoles:function(){return fe.getRequest("api/v1/user/roles/all")},getAllUsers:function(e){return fe.getRequest("api/v1/user/search",e)},getUserProfile:function(){return fe.getRequest("api/v1/user/info")}},Auth:{register:function(e){return fe.postRequest("api/v1/auth/registration",e,"",!1)},login:function(e){return fe.postRequest("api/v1/auth/login",e,"",!1)},refreshToken:function(e){return fe.postRequest("api/v1/auth/refresh",e,"",!1)}},Tour:{insertTour:function(e){return fe.postRequest("api/v1/tour/insert",e)},getTour:function(e){return fe.getRequest("api/v1/tour",e)},updateTour:function(e,t){return fe.postRequest("api/v1/tour/update",e,t)},getAllToursAdmin:function(e){return fe.getRequest("api/v1/tour/searchadmin",e)},removeTour:function(e){return fe.getRequest("api/v1/tour/delete",e)},getTourCategories:function(e){return fe.getRequest("api/v1/tour/categories",e)},updateTourCategories:function(e,t){return fe.postRequest("api/v1/tour/categories/update",e,t)}},SourcePlace:{updateSourcesForPlace:function(e,t){return fe.postRequest("api/v1/sourceplace/update",e,t)}},Source:{getSources:function(){return fe.getRequest("api/v1/source/all")},addSource:function(e){return fe.postRequest("api/v1/source/insert",e)}},Places:{getClosesPlacesAdmin:function(e){return fe.getRequest("api/v1/place/searchadmin/closest",e)},getAllCities:function(e){return fe.getRequest("api/v1/place/city/all",e)},getAllCounties:function(e){return fe.getRequest("api/v1/place/county/all",e)},getAllCountries:function(e){return fe.getRequest("api/v1/place/country/all",e)},getAllMunicipalities:function(e){return fe.getRequest("api/v1/place/municipality/all",e)},getAllPlaces:function(e){return fe.getRequest("api/v1/place/search",e)},insertPlace:function(e){return fe.postRequest("api/v1/place/insert",e)},updatePlace:function(e){return fe.postRequest("api/v1/place/update",e)},getPlaceById:function(e){return fe.getRequest("api/v1/place/getplace",e)},getAllPlacesAdmin:function(e){return fe.getRequest("api/v1/place/searchadmin",e)},searchApiPlaces:function(e){return fe.getRequest("api/v1/placeApi/search",e)},removePlace:function(e){return fe.getRequest("api/v1/place/delete",e)}},Tags:{getAllTags:function(){return fe.getRequest("api/v1/tags/all")},addTag:function(e){return fe.postRequest("api/v1/tags/insert",e)},removeTags:function(e){return fe.postRequest("api/v1/tags/delete",e)},updateTags:function(e){return fe.postRequest("api/v1/tags/update",e)},updateFeaturedTags:function(e){return fe.postRequest("api/v1/tags/featured/update",e)}},Categories:{addCategory:function(e){return fe.postRequest("api/v1/categories/insert",e)},getAllCategories:function(e){return fe.getRequest("api/v1/categories/all",e)},removeCategory:function(e){return fe.postRequest("api/v1/categories/delete",e)},updateCategory:function(e){return fe.postRequest("api/v1/categories/update",e)},getAllAbstractedCategories:function(e){return fe.getRequest("api/v1/categories/all/abstracted",e)},updateAbstractedCategories:function(e){return fe.postRequest("api/v1/categories/update/abstracted",e)},abstractedCategoriesLeftOver:function(){return fe.getRequest("api/v1/categories/abstracted/left")}},Photos:{addPhoto:function(e){return fe.postRequest("api/v1/photo/insert",e)},uploadPhoto:function(e){return fe.postMultipartRequest("api/v1/photo/upload",e)}},Parking:{getParkingByLocation:function(e){return fe.getRequest("api/v1/parking/searchAdmin",e)},insertNewParking:function(e){return fe.postRequest("api/v1/parking/insert",e)}},TagsPlace:{updateTagsForPlace:function(e,t){return fe.postRequest("api/v1/tagsplace/update",e,t)}},CategoriesPlace:{updateCategoriesForPlace:function(e,t){return fe.postRequest("api/v1/categoryplace/update",e,t)}},ParkingPlace:{updateParkingForPlace:function(e,t){return fe.postRequest("api/v1/parkingplace/update",e,t)}},PhotoPlace:{updatePhotoForPlace:function(e,t){return fe.postRequest("api/v1/photoplace/update",e,t)}},Schedule:{updateScheduleForPlace:function(e,t){return fe.postRequest("api/v1/ws/update",e,t)}},Reviews:{getPlaceReviews:function(e){return fe.getRequest("api/v1/reviews/all",e)}}},be=a(224),he=a(28),Ee=a.n(he),ve=a(817),ye=r.a.createContext({alertConfig:null,addAlertConfig:function(){},removeAlertConfig:function(){}});function Oe(e){var t=e.children,a=Object(n.useState)(null),l=Object(m.a)(a,2),i=l[0],o=l[1],c={alertConfig:i,addAlertConfig:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return o({title:e,message:t,actions:a,onClose:n})},removeAlertConfig:function(){return o(null)}};return r.a.createElement(ye.Provider,{value:c},t)}function je(){var e=Object(n.useContext)(ye);return{alertConfig:e.alertConfig,addAlertConfig:e.addAlertConfig,removeAlertConfig:e.removeAlertConfig}}var Ce={DIALOG_PLACE_PUBLISH_TITLE:"Place publicity",DIALOG_PLACE_PUBLISH_MESSAGE:"This place will be visible for all users. Are you sure?",DIALOG_PLACE_UNPUBLISH_MESSAGE:"This place will not be visible anymore. Are you sure?",DIALOG_PLACE_INSERT_TITLE:"Insert place",DIALOG_PLACE_INSERT:"Are you sure you want to insert this place?",DIALOG_PLACE_UPDATE_TITLE:"Update place",DIALOG_PLACE_UPDATE:"Are you sure you want to make changes to this place?",DIALOG_PLACE_VERIFY_TITLE:"Place verification",DIALOG_PLACE_VERIFY_MESSAGE:"This is a user's suggested place. Are you sure you want to verify this place and make it visible to others?",DIALOG_PLACE_DELETE_TITLE:"Delete place",DIALOG_PLACE_DELETE_MESSAGE:"This action will remove this place permanently. Are you sure you want to proceed?",DIALOG_TOUR_DELETE_TITLE:"Delete tour",DIALOG_TOUR_DELETE_MESSAGE:"This action will remove this tour permanently. Are you sure you want to proceed?",SNACKBAR_PLACE_INSERTED_SUCCESS:"Place inserted successfully",SNACKBAR_PLACE_REMOVE_SUCCESS:"Place was removed successfully",SNACKBAR_TOUR_INSERTED_SUCCESS:"Tour inserted successfully",SNACKBAR_TOUR_REMOVE_SUCCESS:"Tour was removed successfully",SNACKBAR_ERROR:"Something went wrong!",SNACKBAR_CHANGES_SAVED:"All changes saved!"},Se=r.a.createContext({config:null,addConfig:function(){},removeConfig:function(){}});function ke(e){var t=e.children,a=Object(n.useState)(null),l=Object(m.a)(a,2),i=l[0],o=l[1],c={config:i,addConfig:function(e,t){return function(e,t){return o({success:e,message:t})}(e,t)},removeConfig:function(){return o(null)}};return r.a.createElement(Se.Provider,{value:c},t)}function Ie(){var e=Object(n.useContext)(Se);return{config:e.config,addConfig:e.addConfig,removeConfig:e.removeConfig}}var xe=a(789),we=a(815),Pe=a(788),Te=a(790),Ae=a(11),De=a(814),Ne=a(822);var Re=Object(L.a)((function(e){return{autoComplete:{margin:e.spacing(1)},chip:{margin:e.spacing(.5)},root:{display:"flex",justifyContent:"left",flexWrap:"wrap",listStyle:"none",padding:e.spacing(1),margin:0},autoCompleteChipContainer:{padding:e.spacing(1)}}}))((function(e){var t=e.options,a=e.setOptions,l=e.selectedOptions,i=e.setSelectedOptions,o=e.classes,c=e.label,s=e.id,u=e.name,d=Object(n.useState)([]),p=Object(m.a)(d,2),f=p[0],g=p[1],b=Object(n.useState)({name:""}),h=Object(m.a)(b,2),E=h[0],v=h[1],y=Object(n.useState)(!0),O=Object(m.a)(y,2),j=O[0],C=O[1];function S(e){i(l.filter((function(t){return t!==e}))),a([].concat(Object(Ae.a)(t),[e]))}return Object(n.useEffect)((function(){0===l.length&&a(f)}),[l]),Object(n.useEffect)((function(){if(j&&t.length>0){var e=[];t.map((function(t){var a=!1;l.map((function(e){JSON.stringify(t)===JSON.stringify(e)&&(a=!0)})),a||e.push(t)})),a(e),g(e),C(!1)}}),[t]),r.a.createElement("div",null,r.a.createElement(ve.a,{className:o.autoCompleteChipContainer},0!==l.length&&r.a.createElement(ve.a,{component:"ul",className:o.root},l.map((function(e){return void 0!==s?r.a.createElement("li",{key:e[s]},r.a.createElement(Ne.a,{variant:"outlined",label:void 0!==u?e[u]:e.name,onDelete:function(){return S(e)},className:o.chip})):r.a.createElement("li",{key:e},r.a.createElement(Ne.a,{variant:"outlined",label:e,onDelete:function(){return S(e)},className:o.chip}))}))),r.a.createElement(De.a,{className:o.autoComplete,value:E,options:t,onChange:function(e,n){v({name:""}),i([].concat(Object(Ae.a)(l),[n])),a(t.filter((function(e){return e!==n})))},disableClearable:!0,getOptionLabel:function(e){return"string"===typeof e?e:e.name},renderInput:function(e){return r.a.createElement(J.a,Object.assign({},e,{label:c,variant:"outlined"}))}})))})),Le=a(18),Me=a.n(Le),_e=a(15),Fe=a.n(_e),He=a(219),qe=a(378),We=a.n(qe),Be=r.a.createContext();function Ue(e){var t=e.children,a=Object(n.useState)({keyword:"",page:1}),l=Object(m.a)(a,2),i=l[0],o=l[1];return r.a.createElement(Be.Provider,{value:{savePlacesTableInfo:function(e,t){var a=Object(p.a)({},i);a.keyword=e,a.page=t,console.log("Saving",{keyword:e,page:t}),o(a)},placesPageConfig:i}},t)}var ze=r.a.createContext();function Ge(e){var t=e.children,a=Object(n.useState)([]),l=Object(m.a)(a,2),i=l[0],o=l[1],c=Object(n.useState)([]),s=Object(m.a)(c,2),u=s[0],d=s[1];return Object(n.useEffect)((function(){ge.Categories.getAllCategories().then(o).catch((function(e){})),ge.Tags.getAllTags().then(d).catch((function(e){}))}),[]),r.a.createElement(ze.Provider,{value:{globalCategories:i,globalTags:u}},t)}var Ye=r.a.createContext(),Ve=a(309),Ke={insertionStart:_e(new Date("2020-05-01T21:11:54")).format("YYYY-MM-DD"),insertionEnd:_e(new Date).add(1,"day").format(),modificationStart:_e(new Date("2014-05-01T21:11:54")).format("YYYY-MM-DD"),modificationEnd:_e(new Date).add(1,"day").format()},$e=function(e){var t=e.children,a=Object(n.useState)([]),l=Object(m.a)(a,2),i=l[0],o=l[1],c=Object(n.useState)([]),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)([]),f=Object(m.a)(p,2),g=f[0],b=f[1],h=Object(n.useState)([]),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)([]),j=Object(m.a)(O,2),C=j[0],S=j[1],k=Object(n.useState)([]),I=Object(m.a)(k,2),x=I[0],w=I[1],P=Object(n.useState)([]),T=Object(m.a)(P,2),A=T[0],D=T[1],N=Object(n.useState)([]),R=Object(m.a)(N,2),L=R[0],M=R[1],_=Object(n.useState)([]),F=Object(m.a)(_,2),H=F[0],q=F[1],W=Object(n.useState)([]),B=Object(m.a)(W,2),U=B[0],z=B[1],G=Object(n.useState)([]),Y=Object(m.a)(G,2),V=Y[0],K=Y[1],$=Object(n.useState)([]),J=Object(m.a)($,2),Z=J[0],X=J[1],Q=Object(n.useState)(!0),ee=Object(m.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(m.a)(ne,2),le=re[0],ie=re[1],oe=Object(n.useContext)(ze),ce=oe.globalCategories,se=oe.globalTags,ue=Object(n.useState)([{filterLabel:"Unverified",filter:!1,filterName:"unverified"},{filterLabel:"Unpublished",filter:!1,filterName:"unpublished"}]),de=Object(m.a)(ue,2),me=de[0],pe=de[1],fe=Object(n.useState)(Ke),be=Object(m.a)(fe,2),he=be[0],Ee=be[1],ve=Object(n.useState)(Ve(null,{queryParams:{di:[he.insertionStart,he.insertionEnd],dm:[he.modificationStart,he.modificationEnd],filterOptions:xe(),categories:ke(),tags:Ie(),countries:L,cities:x,municipalities:U}})),ye=Object(m.a)(ve,2),Oe=ye[0],je=ye[1];Object(n.useEffect)((function(){o(JSON.parse(JSON.stringify(ce)))}),[ce]),Object(n.useEffect)((function(){b(JSON.parse(JSON.stringify(se)))}),[se]);var Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ge.Places.getAllCities(e).then((function(e){S(e)})).catch((function(e){}))},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ge.Places.getAllMunicipalities(e).then((function(e){q(e)})).catch((function(e){}))};function ke(){return u.map((function(e){return e.categoryId}))}function Ie(){return v.map((function(e){return e.tagId}))}function xe(){var e=[];return me.map((function(t){!0===t.filter&&e.push(t.filterName)})),e}Object(n.useEffect)((function(){te||(Se(Ve(null,{queryParams:{countryRestrictions:L}})),Ce(Ve(null,{queryParams:{munRestrictions:U,countryRestrictions:L}})))}),[L]),Object(n.useEffect)((function(){te||Ce(Ve(null,{queryParams:{munRestrictions:U,countryRestrictions:L}}))}),[U]),Object(n.useEffect)((function(){Promise.all([Ce(),void ge.Places.getAllCountries().then((function(e){D(e)})).catch((function(e){})),void ge.Places.getAllCounties().then((function(e){K(e)})).catch((function(e){})),Se()]).then((function(e){ae(!1)})).catch((function(e){}))}),[]),Object(n.useEffect)((function(){te||(le?function(){var e=!0;return me.map((function(t){t.filter&&(e=!1)})),e&&0===u.length&&0===v.length&&0===x.length&&0===L.length&&he.insertionStart===Ke.insertionStart&&he.modificationStart===Ke.modificationStart}()&&ie(!1):je(Ve(null,{queryParams:{di:[he.insertionStart,he.insertionEnd],dm:[he.modificationStart,he.modificationEnd],o:xe(),c:ke(),tags:Ie(),countries:L,cities:x,municipalities:U}})))}),[u,v,x,L,U,he,me,le]);var we={filterQuery:Oe,setResetFilterOptions:ie,dates:he,setDates:Ee,filterOptions:me,setFilterOptions:pe,categories:i,setCategories:o,selectedCategories:u,setSelectedCategories:d,tags:g,setTags:b,selectedTags:v,setSelectedTags:y,counties:V,setCounties:K,selectedCounties:Z,setSelectedCounties:X,cities:C,setCities:S,selectedCities:x,setSelectedCities:w,countries:A,setCountries:D,selectedCountries:L,setSelectedCountries:M,municipalities:H,setMunicipalities:q,selectedMunicipalities:U,setSelectedMunicipalities:z};return r.a.createElement(Ye.Provider,{value:we},t)};var Je=Me()((function(e){return{filterDiv:{display:"flex",flexDirection:"row"},sortingButtons:{display:"flex",flexDirection:"column",padding:e.spacing(1),height:"100%"},rightLayout:{boxShadow:"0 0 1px 0 #666",display:"flex",flexDirection:"column",padding:e.spacing(1)},datesLayout:{padding:e.spacing(1),display:"flex",flexDirection:"row",justifyContent:"space-between"},root:{flexGrow:1,width:"100%",marginBottom:"8px",boxShadow:"0 0 1px 0 #666",padding:e.spacing(1)},paper:{display:"flex",flexDirection:"column",padding:e.spacing(2),textAlign:"center"}}}))((function(e){var t=e.classes,a=(e.setOpen,Object(n.useContext)(Ye)),l=a.tags,i=a.setTags,o=a.selectedTags,c=a.setSelectedTags,s=a.categories,u=a.setCategories,d=a.selectedCategories,p=a.setSelectedCategories,f=a.cities,g=a.setCities,b=a.selectedCities,h=a.setSelectedCities,E=a.countries,v=a.setCountries,y=a.selectedCountries,O=a.setSelectedCountries,C=a.municipalities,S=a.setMunicipalities,k=a.selectedMunicipalities,I=a.setSelectedMunicipalities,x=a.filterOptions,w=a.setFilterOptions,P=a.setResetFilterOptions,T=a.dates,A=a.setDates,D=Object(n.useState)(!1),N=Object(m.a)(D,2),R=N[0],L=N[1];function M(e,t){var a=Object.assign({},T);a[t]=Fe()(e).format("YYYY-MM-DD"),A(a)}return r.a.createElement(G.a,{className:t.root},r.a.createElement(Pe.a,{container:!0,direction:"row",spacing:3},r.a.createElement(Pe.a,{item:!0,xs:12,sm:4},r.a.createElement(G.a,{className:t.paper},r.a.createElement(j.a,{variant:"h6"},"General options"),r.a.createElement("div",{className:t.sortingButtons},x.map((function(e){return r.a.createElement(xe.a,{key:e.filterName,control:r.a.createElement(we.a,{checked:e.filter,onChange:function(){return function(e){var t=Object.assign([],x);t.map((function(t){t.filterName===e&&(t.filter=!t.filter)})),w(t)}(e.filterName)},name:e.filterName}),label:e.filterLabel})}))),r.a.createElement(j.a,{variant:"h6"},"Filter by categories"),r.a.createElement(Re,{label:"Select categories",id:"categoryId",options:s,setOptions:u,selectedOptions:d,setSelectedOptions:p}),r.a.createElement(j.a,{variant:"h6"},"Filter by tags"),r.a.createElement(Re,{label:"Select tags",id:"tagId",options:l,setOptions:i,selectedOptions:o,setSelectedOptions:c}))),r.a.createElement(Pe.a,{item:!0,xs:12,sm:4},r.a.createElement(G.a,{className:t.paper},r.a.createElement(j.a,{variant:"h6"},"Filter by countries"),r.a.createElement(Re,{label:"Select countries",options:E,setOptions:v,selectedOptions:y,setSelectedOptions:O}),r.a.createElement(j.a,{variant:"h6"},"Filter by municipalities"),r.a.createElement(Re,{label:"Select municipalities",options:C,setOptions:S,selectedOptions:k,setSelectedOptions:I}),r.a.createElement(j.a,{variant:"h6"},"Filter by cities"),r.a.createElement(Re,{label:"Select cities",options:f,setOptions:g,selectedOptions:b,setSelectedOptions:h}))),r.a.createElement(Pe.a,{item:!0,xs:12,sm:4},r.a.createElement(G.a,{className:t.paper},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}},r.a.createElement(j.a,{variant:"h6"},"Filter by dates"),r.a.createElement(we.a,{checked:R,onChange:function(e){return L(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}})),R&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"subtitle1"},"Insertion dates"),r.a.createElement(Pe.a,{container:!0,justify:"space-around"},r.a.createElement(We.a,{utils:He.a},r.a.createElement(Te.b,{disableToolbar:!0,variant:"inline",format:"MM-dd-yyyy",margin:"normal",id:"insertionStart",onChange:function(e){return M(e,"insertionStart")},value:T.insertionStart,label:"Date start",KeyboardButtonProps:{"aria-label":"change date"}}),r.a.createElement(Te.b,{disableToolbar:!0,variant:"inline",format:"MM-dd-yyyy",margin:"normal",value:T.insertionEnd,onChange:function(e){return M(e,"insertionEnd")},id:"insertionEnd",label:"Date end",KeyboardButtonProps:{"aria-label":"change date"}}))),r.a.createElement(j.a,{variant:"subtitle1"},"Modification dates"),r.a.createElement(Pe.a,{container:!0,justify:"space-around"},r.a.createElement(Te.b,{disableToolbar:!0,variant:"inline",format:"MM-dd-yyyy",margin:"normal",value:T.modificationStart,onChange:function(e){return M(e,"modificationStart")},id:"modificationStart",label:"Date start",KeyboardButtonProps:{"aria-label":"change date"}}),r.a.createElement(Te.b,{disableToolbar:!0,variant:"inline",format:"MM-dd-yyyy",margin:"normal",value:T.modificationEnd,onChange:function(e){return M(e,"modificationEnd")},id:"modificationEnd",label:"Date end",KeyboardButtonProps:{"aria-label":"change date"}})))))),r.a.createElement(be.a,{style:{marginTop:8},variant:"contained",color:"primary",onClick:function(){return function(){P(!0),c([]),h([]),O([]),p([]),I([]);var e=Object.assign(x,[]);e.map((function(e){e.filter=!1})),w(e),A({insertionStart:Fe()(new Date("2020-05-01T21:11:54")).format("YYYY-MM-DD"),insertionEnd:Fe()(new Date).add(1,"day").format(),modificationStart:Fe()(new Date("2014-05-01T21:11:54")).format("YYYY-MM-DD"),modificationEnd:Fe()(new Date).add(1,"day").format()})}()}},"Clear filters"))})),Ze=[{id:"name",numeric:!1,disablePadding:!1,label:"Place name",isId:!0},{id:"address",numeric:!1,disablePadding:!1,label:"Address",isId:!1},{id:"city",numeric:!1,disablePadding:!1,label:"City",isId:!1},{id:"country",numeric:!1,disablePadding:!1,label:"Country",isId:!1},{id:"dateModified",numeric:!1,disablePadding:!1,label:"Date modified",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}];var Xe=Object(L.a)((function(e){var t;return{button:{margin:e.spacing(2)},input:{display:"none"},root:{height:"100vh",width:"100%",overflow:"auto"},buttonsDiv:{backgroundColor:"red",justifyContent:"flex-end"},content:(t={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Object(d.a)(t,e.breakpoints.down("lg"),{padding:e.spacing(1)}),Object(d.a)(t,e.breakpoints.up("lg"),{padding:e.spacing(8)}),t),autocomplete:{width:"200px",height:"40px",fontSize:"14px",border:"0",borderBottom:"2px solid grey",outline:"0",marginBottom:"4px"}}}))((function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),l=a[0],i=a[1],o=Object(n.useState)([]),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)(!0),p=Object(m.a)(d,2),f=p[0],g=p[1],b=e.classes,h=Object(n.useContext)(Ye).filterQuery,E=je().addAlertConfig,v=Ie().addConfig,y=Object(n.useContext)(Be),O=y.placesPageConfig,j=y.savePlacesTableInfo;function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.page,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.keyword;console.log(h+"&p="+e+"&s=10&keyword="+t),k(h+"&p="+e+"&s=10&keyword="+t)}function S(e){g(!1);var t=[];e.list.map((function(e){t.push(e)})),delete e.list,i(t),console.log(t),u(e)}return Object(n.useEffect)((function(){g(!0),f?C():(j(O.keyword,1),C(1,O.keyword))}),[h]),r.a.createElement("div",{className:b.root},r.a.createElement("div",{className:b.content},r.a.createElement(Je,{setOpen:!0}),r.a.createElement(ae,{title:"Places",headCells:Ze,data:l,pagingInfo:s,checkable:!1,changePageCallback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";f||(g(!0),j(t,e),C(e,t))},updateCallback:function(e){se.push("/app/addplace/"+e)},removeCallback:function(e){g(!0),E(Ce.DIALOG_PLACE_DELETE_TITLE+" - "+function(e){for(var t=0;t<l.length;t++)if(l[t].placeId===e)return l[t].name}(e),Ce.DIALOG_PLACE_DELETE_MESSAGE,[{name:"Remove",action:function(){ge.Places.removePlace("?p="+e).then((function(t){var a=[];l.map((function(t){t.placeId!==e&&a.push(t)})),i(a),v(!0,Ce.SNACKBAR_PLACE_REMOVE_SUCCESS),g(!1)})).catch((function(e){g(!1),v(!1,Ce.SNACKBAR_ERROR)}))}}],(function(){g(!1)}))},initialKeyword:O.keyword,id:"placeId",isLoading:f}),r.a.createElement(ve.a,{display:"flex",justifyContent:"flex-end"},r.a.createElement(be.a,{onClick:function(){se.push("/app/addplace")},variant:"text",color:"secondary",size:"large",className:b.button,startIcon:r.a.createElement(Ee.a,null)},"Add"))),r.a.createElement(be.a,null,"Clear filters"));function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ge.Places.getAllPlacesAdmin(e).then((function(e){g(!1),S(e)})).catch((function(e){g(!1),console.log(e)}))}})),Qe=a(45),et=a.n(Qe),tt=a(824),at=[{value:0,label:"FREE"},{value:25,label:"$"},{value:50,label:"$$"},{value:75,label:"$$$"},{value:100,label:"$$$$"},{value:125,label:"$$$$$"}],nt=[{value:5,label:5},{value:10,label:10},{value:15,label:15},{value:30,label:30},{value:45,label:45},{value:60,label:60},{value:90,label:90},{value:120,label:120},{value:150,label:150},{value:180,label:180},{value:210,label:210},{value:240,label:240},{value:270,label:270}],rt=a(730),lt=a(731),it=a(742),ot=a(737),ct=a(740),st=a(792),ut=a(739);var dt=Object(L.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){e.classes;var t=e.open,a=e.action,l=e.setDialogOpen,i=Object(n.useState)(""),o=Object(m.a)(i,2),c=o[0],s=o[1],u=Object(n.useState)(""),d=Object(m.a)(u,2),p=d[0],f=d[1],g=Object(n.useState)(!1),b=Object(m.a)(g,2),h=b[0],E=b[1];return r.a.createElement("div",null,r.a.createElement(ot.a,{"aria-labelledby":"customized-dialog-title",open:t,fullWidth:!0},r.a.createElement(st.a,{id:"customized-dialog-title"},"Insert source"),r.a.createElement(ut.a,{dividers:!0},r.a.createElement(J.a,{error:h,onChange:function(e){s(e.target.value)},label:"Source name",variant:"outlined",fullWidth:!0}),r.a.createElement(J.a,{style:{marginTop:"16px"},error:h,onChange:function(e){f(e.target.value)},label:"Source url",variant:"outlined",fullWidth:!0})),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return l(!1)},color:"primary"},"Cancel"),r.a.createElement(be.a,{autoFocus:!0,color:"primary",onClick:function(){!function(){var e=!1;return(c.length<=3||p.length<=3)&&(e=!0),E(e),e}()&&a(c,p),l(!1)}},"Add"))))}));var mt=Object(L.a)((function(e){return{}}))((function(e){var t=e.classes,a=e.placeInfo,l=e.setPlaceInfo,i=e.selectedSources,o=e.setSelectedSources,c=function(e,t){var n=e.target,r=n.name,i=n.value,o=n.id,c=Object.assign({},a,{});""!==o?c[o]=v(t[0]):c[r]=i,l(c)};Object(n.useEffect)((function(){ge.Source.getSources().then((function(e){E(e)})).catch((function(e){}))}),[]);var s=Object(n.useState)(!1),u=Object(m.a)(s,2),d=u[0],f=u[1],g=Object(n.useState)([]),b=Object(m.a)(g,2),h=b[0],E=b[1];function v(e){var t="";return at.map((function(a){a.value===e&&(t=a.label)})),t}return r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Basic place information"),r.a.createElement("br",null),r.a.createElement(J.a,{required:!0,label:"Place name",style:{margin:8},placeholder:"Enter the place name",fullWidth:!0,value:a.name,name:"name",onChange:function(e){return c(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{label:"Place description",style:{margin:8},placeholder:"Describe the place thoroughly",fullWidth:!0,multiline:!0,name:"description",value:a.description,onChange:function(e){return c(e)},variant:"outlined",rows:15,margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{label:"Phone number",style:{margin:8},placeholder:"Enter phone number",fullWidth:!0,name:"phoneNumber",value:a.phoneNumber,onChange:function(e){return c(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(xe.a,{style:{width:"100%",marginLeft:5},control:r.a.createElement(we.a,{name:"checkedB",color:"primary",checked:a.bookInAdvance||!1,onChange:function(e){return l((function(e){return Object(p.a)(Object(p.a)({},e),{},{bookInAdvance:!e.bookInAdvance||!1})}))}}),label:r.a.createElement("span",{style:{fontSize:16}},"Requires booking in advance")}),r.a.createElement(J.a,{label:"Website",style:{margin:8},placeholder:"Enter website",fullWidth:!0,name:"website",value:a.website,onChange:function(e){return c(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Re,{id:"source",label:"Select sources",options:h,setOptions:E,setSelectedOptions:o,selectedOptions:i}),r.a.createElement(be.a,{variant:"text",color:"primary",size:"small",className:t.button,onClick:function(){return f(!0)},startIcon:r.a.createElement(Ee.a,null)},"Add missing source"),r.a.createElement(dt,{action:function(e,t){ge.Source.addSource({name:e,url:t}).then((function(e){E([].concat(Object(Ae.a)(h),[e])),o([].concat(Object(Ae.a)(i),[e]))})).catch((function(e){console.log(e)}))},open:d,setDialogOpen:f}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(j.a,null,"Price"),r.a.createElement(tt.a,{id:"price",onChange:c,value:at.map((function(e){if(e.label===a.price)return e.value})),style:{width:"60%",marginLeft:"48px"},defaultValue:0,getAriaValueText:v,"aria-labelledby":"discrete-slider-always",step:25,max:125,marks:at})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(j.a,null,"Average time spent"),r.a.createElement(rt.a,{variant:"outlined",style:{width:"60%",marginLeft:"48px"}},r.a.createElement(lt.a,null,"Minutes"),r.a.createElement(it.a,{native:!0,value:parseInt(a.averageTimeSpent,10),onChange:c,label:"Average Time spent",inputProps:{name:"averageTimeSpent"}},r.a.createElement("option",{value:"-1"},"None"),nt.map((function(e){return r.a.createElement("option",{value:parseInt(e.value,10)}," ",e.value)}))))))})),pt=a(39),ft=a(379),gt=a(794),bt=a(793),ht=a(795),Et=function(e){e.index;var t=e.onItemDelete,a=e.photo,n=e.margin,l=e.direction,i=e.top,o=e.left,c={imgContainer:{margin:n,display:"inline",position:"relative",width:"300px",height:"300px"}};"column"===l&&(c.imgContainer.position="absolute",c.imgContainer.imgStyle.left=o,c.imgContainer.imgStyle.top=i);return r.a.createElement(bt.a,{style:c.imgContainer},r.a.createElement(gt.a,{style:{height:0,paddingTop:"80%"},image:a.src}),r.a.createElement(ht.a,{disableSpacing:!0},r.a.createElement(be.a,{variant:"contained",color:"secondary",startIcon:r.a.createElement(V.a,null),onClick:function(e){t(a)}},"Delete")))},vt=Object(pt.b)((function(e){return r.a.createElement(Et,e)})),yt=Object(pt.a)((function(e){var t=e.items,a=e.onItemDelete;return r.a.createElement(ft.a,{photos:t,renderImage:function(e){return r.a.createElement(vt,Object.assign({},e,{onItemDelete:a}))}})}));var Ot=function(e){var t=e.setPhotos,a=e.photos,n=e.srcName,l=e.keyName,i=a.map((function(e){return{key:e[l].toString(),src:e[n],width:1,height:1}}));return r.a.createElement("div",null,r.a.createElement(yt,{pressDelay:200,disableAutoscroll:!1,items:i,onSortEnd:function(e){var n=e.oldIndex,r=e.newIndex;t(Object(pt.c)(a,n,r))},axis:"xy",onItemDelete:function(e){t(a.filter((function(t){return t[l].toString()!==e.key})))}}))},jt=a(412),Ct=[".jpeg",".png",".bmp",".jpg"];var St=Object(L.a)((function(e){return{dropzoneArea:{overflow:"hidden"}}}))((function(e){var t=e.onCloseCallback,a=e.open,l=e.onFinishCallback,i=e.classes,o=Object(n.useState)(!1),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)([]),p=Object(m.a)(d,2),f=p[0],g=p[1];return r.a.createElement("div",null,r.a.createElement(ot.a,{"aria-labelledby":"customized-dialog-title",open:a,fullWidth:!0},r.a.createElement(st.a,{id:"customized-dialog-title"},"Photo upload"),s&&r.a.createElement(Z.a,{variant:"query"}),r.a.createElement(ut.a,{dividers:!0},r.a.createElement(jt.a,{className:i.dropzoneArea,acceptedFiles:Ct,maxFileSize:25e6,showAlerts:["error"],dropzoneProps:{disabled:s},filesLimit:5,onDrop:function(e){g((function(t){return[].concat(Object(Ae.a)(t),Object(Ae.a)(e))}))},onDelete:function(e){console.log(e.name),g((function(t){return t.filter((function(t){return t!==e}))}))}})),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:t,color:"primary"},"Cancel"),r.a.createElement(be.a,{onClick:function(){u(!0),Promise.all(f.map((function(e){var t=new FormData;return t.append("image",e),ge.Photos.uploadPhoto(t).then((function(e){return e}))}))).then((function(e){console.log(e),l(e)})).catch((function(e){l(null)})).finally((function(){g([]),u(!1)}))},color:"primary"},"Submit"))))}));var kt=Me()((function(e){return{outline:{margin:e.spacing(1),padding:e.spacing(1),width:"100%"},button:{margin:e.spacing(2)}}}))((function(e){var t=e.classes,a=e.setPhotos,l=e.photos,i=Object(n.useState)(!1),o=Object(m.a)(i,2),c=o[0],s=o[1],u=Ie().addConfig;return r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Photos"),r.a.createElement(bt.a,{variant:"outlined",className:t.outline},l.length>0&&r.a.createElement(Ot,{keyName:"photoId",srcName:"url",setPhotos:a,photos:l}),r.a.createElement(be.a,{variant:"text",color:"primary",size:"small",style:{width:"15%"},className:t.button,onClick:function(){return s(!0)},startIcon:r.a.createElement(Ee.a,null)},"Add photo"),r.a.createElement(St,{open:c,onFinishCallback:function(e){return function(e){s(!1),null!=e?(u(!0,"Photos were uploaded successfully."),a([].concat(Object(Ae.a)(l),Object(Ae.a)(e)))):u(!1,"Something went wrong")}(e)},onCloseCallback:function(){return s(!1)}})))})),It=a(42),xt=a(221),wt=a.n(xt);wt.a.setApiKey("AIzaSyDGFjZHSoRrZ2AEO0ONXvjuN4RiCmknXf8");function Pt(e,t){return wt.a.fromLatLng(e,t).then((function(a){var n=a.results[0].formatted_address,r=a.results[0].address_components;if(void 0!==r){var l=function(e){if(void 0!==e){for(var t="",a=0;a<e.length;a++)if(e[a].types[0]&&"locality"===e[a].types[0])return t=e[a].long_name;return t}}(r),i=function(e){if(void 0!==e)for(var t=0;t<e.length;t++)if(e[t].types[0]&&"country"===e[t].types[0])return e[t].long_name}(r),o=function(e){if(void 0!==e){for(var t="",a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return t=e[a].long_name;return t}}(r),c=function(e){if(void 0!==e){for(var t="",a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_2"===e[a].types[0])return t=e[a].long_name;return t}}(r);return{address:n,city:l,country:i,latitude:e,longitude:t,county:o,municipality:c}}return null}),(function(e){return null}))}var Tt=a(392),At=a.n(Tt),Dt=a(393),Nt=a.n(Dt);var Rt=Me()((function(e){return{content:{margin:e.spacing(1)},autocomplete:{width:"200px",height:"40px",fontSize:"14px",border:"0",borderBottom:"2px solid grey",outline:"0",marginBottom:"4px"},root:{display:"flex",flexDirection:"column",marginTop:"8px",padding:e.spacing(1)}}}))((function(e){var t=e.classes,a=e.isLocked,l=e.locationCallback,i=Object(n.useState)(!1),o=Object(m.a)(i,2),c=o[0],s=o[1],u=je().addAlertConfig;function d(){u("Error parsing location!","Make sure that address you provided is correct!",[])}function p(e){var t,a=e.target.value;if(13===e.which||13===e.keyCode){if(s(!0),/[a-zA-Z]+/.test(a))(t=a,wt.a.fromAddress(t).then((function(e){var t=e.results[0].geometry.location,a=t.lat,n=t.lng;return void 0!==a&&void 0!==n?Pt(a,n).then((function(e){return e})):null}),(function(e){return null}))).then((function(e){null!==e?l(e):d(),s(!1)}));else{var n=a.split(/[ ,]+/);2===n.length&&Pt(parseFloat(n[0]),parseFloat(n[1])).then((function(e){null!==e?l(e):d(),s(!1)}))}return!1}return!0}return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.content},r.a.createElement(At.a,{onKeyPress:function(e){a||p(e)},onPlaceSelected:function(e){a||function(e){(s(!0),void 0!==e.address_components)&&Pt(e.geometry.location.lat(),e.geometry.location.lng()).then((function(e){null!==e?l(e):d(),s(!1)}))}(e)},className:t.autocomplete,types:["(regions)"]}),r.a.createElement(S.a,{"aria-label":"delete",className:t.margin,size:"small"},r.a.createElement(Nt.a,{onClick:function(){a||(s(!0),navigator.geolocation.getCurrentPosition((function(e){Pt(e.coords.latitude,e.coords.longitude).then((function(e){null!==e?l(e):d(),s(!1)}))}),(function(e){s(!1),alert(e.message+"\n"+JSON.stringify(e))})))},fontSize:"large",color:"primary"}))),c?r.a.createElement(Z.a,null):null)})),Lt=a(797),Mt=a(812);var _t=Me()((function(e){return{root:{display:"flex",flexDirection:"column",marginTop:"8px",padding:e.spacing(1)}}}))((function(e){var t=e.classes,a=e.isLocked,n=e.setIsLocked;return r.a.createElement("div",{className:t.root},r.a.createElement(xe.a,{control:r.a.createElement(Lt.a,null),label:"Lock",checked:a,onChange:function(){n((function(e){return!e}))}}),a?r.a.createElement(Mt.a,{severity:"error"},"Map is currently locked. If you want to do any changes unlock it."):null)})),Ft=a(44),Ht=a(7),qt=a.n(Ht);function Wt(e,t){var a=e.position,i=void 0===a?window.google.maps.ControlPosition.TOP_LEFT:a,o=e.children,c=t[Ft.MAP],s=document.createElement("div");return Object(n.useEffect)((function(){var e=c.controls[i],t=e.length;return e.push(s),function(){e.removeAt(t)}})),Object(l.createPortal)(r.a.createElement("div",{style:{marginBottom:8,marginTop:8}},o),s)}Wt.contextTypes=Object(d.a)({},Ft.MAP,qt.a.object);var Bt=a(213),Ut=a.n(Bt),zt=a(819),Gt=a(309),Yt=Object(It.withGoogleMap)((function(e){return r.a.createElement(It.GoogleMap,{defaultZoom:15,ref:e.refInstance,center:{lat:e.position.latitude,lng:e.position.longitude},defaultCenter:{lat:e.position.latitude,lng:e.position.longitude}},e.children)}));var Vt=Me()((function(e){return{largeIcon:{width:e.spacing(14),height:e.spacing(14)}}}))((function(e){var t=e.classes,l=e.placeInfo,i=e.locationMarker,o=e.setLocationMarker,c=e.setParkingLocationMarker,s=Object(n.useState)([]),u=Object(m.a)(s,2),d=u[0],p=u[1],f=Object(n.useState)([]),g=Object(m.a)(f,2),b=g[0],h=g[1],E=Object(n.useState)(""!==l.placeId),v=Object(m.a)(E,2),y=v[0],O=v[1],C=Object(n.useRef)(null);return Object(n.useEffect)((function(){ge.Places.getAllPlacesAdmin(Gt(null,{queryParams:{p:"0",s:"10",range:3,l:[i.latitude,i.longitude]}})).then((function(e){p(e.list)})).catch((function(e){}))}),[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{isLocked:y,locationCallback:function(e){c(e),o(e)}}),r.a.createElement(Yt,{loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"400px"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),refInstance:C,position:i},d.map((function(e,n){var i=parseFloat(e.latitude),o=parseFloat(e.longitude);return""===l.placeId?r.a.createElement(It.Marker,{key:e.placeId,zIndex:1,position:{lat:i,lng:o},icon:{url:a(365),scaledSize:new window.google.maps.Size(48,48),origin:new window.google.maps.Point(0,0)},onClick:function(){if(!y){var e=Object.assign([],b);e[n]=!0,h(e)}}},b[n]&&r.a.createElement(It.InfoWindow,{onCloseClick:function(){var e=Object.assign([],b);e[n]=!1,h(e)}},r.a.createElement(bt.a,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},e.photos.length>0?r.a.createElement(zt.a,{alt:"Remy Sharp",src:e.photos[0].url,className:t.largeIcon}):null,r.a.createElement(j.a,{variant:"h6"},e.name)))):null})),r.a.createElement(It.Marker,{name:"Dolores park",visible:!0,draggable:!y,zIndex:2,onDragEnd:function(e){var t;Pt((t=e).latLng.lat(),t.latLng.lng()).then((function(e){o(e),c(e)}))},position:{lat:i.latitude,lng:i.longitude}}),r.a.createElement(Wt,{position:window.google.maps.ControlPosition.BOTTOM_CENTER},r.a.createElement("div",null,r.a.createElement(S.a,{"aria-label":"delete",onClick:function(){if(!y){var e=C.current.getCenter();Pt(e.lat(),e.lng()).then((function(e){o(e),c(e)}))}}},r.a.createElement(Ut.a,{fontSize:"large"}))))),r.a.createElement(_t,{isLocked:y,setIsLocked:O}))}));var Kt=Me()((function(e){return{outline:{margin:e.spacing(1),padding:e.spacing(1),width:"100%"},button:{margin:e.spacing(2)}}}))((function(e){var t=e.locationData,a=e.setLocationData,n=e.setParkingLocation,l=e.placeInfo;function i(e){var r=e.target,l=r.name,i=r.value,o=Object.assign({},t,{});o[l]=i,n(o),a(o)}return r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Place location"),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Select place location from map"),r.a.createElement("br",null),r.a.createElement(Vt,{placeInfo:l,locationMarker:t,setParkingLocationMarker:n,setLocationMarker:a}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Place location"),r.a.createElement("br",null),r.a.createElement(J.a,{required:!0,label:"Address",style:{margin:8},placeholder:"Enter place address",fullWidth:!0,disabled:!0,value:t.address,name:"address",onChange:function(e){i(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{required:!0,label:"City",disabled:!0,style:{margin:8},placeholder:"Enter place city",fullWidth:!0,value:t.city,name:"city",onChange:function(e){i(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{required:!0,label:"County",disabled:!0,style:{margin:8},placeholder:"Enter place county",fullWidth:!0,value:t.county,name:"county",onChange:function(e){i(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{required:!0,label:"Municipality",disabled:!0,style:{margin:8},placeholder:"Enter place municipality",fullWidth:!0,value:t.municipality,name:"municipality",onChange:function(e){i(e)},variant:"outlined",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(J.a,{required:!0,label:"Country",style:{margin:8},placeholder:"Enter place country",fullWidth:!0,disabled:!0,value:t.country,name:"country",onChange:function(e){i(e)},variant:"outlined",rows:4,margin:"normal",InputLabelProps:{shrink:!0}}))})),$t=Object(It.withGoogleMap)((function(e){return r.a.createElement(It.GoogleMap,{ref:e.refInstance,defaultZoom:12,center:{lat:e.position.latitude,lng:e.position.longitude},defaultCenter:{lat:e.position.latitude,lng:e.position.longitude}},r.a.createElement(It.Marker,{onClick:function(){e.isLocked||e.setMainInfoWindow(!0)},name:"Dolores park",visible:!0,draggable:!e.isLocked,onDragEnd:function(t){return function(e,t){var a=e.latLng.lat(),n=e.latLng.lng();Pt(a,n).then((function(e){t(e)}))}(t,e.setPosition)},position:{lat:e.position.latitude,lng:e.position.longitude}},e.mainInfoWindow&&r.a.createElement(It.InfoWindow,{onCloseClick:function(){e.setMainInfoWindow(!1)}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},e.position.address,r.a.createElement(be.a,{onClick:function(){var t=function(e,t){for(var a=0,n=0;n<t.length;n++){Zt(e.latitude,e.longitude,t[n].latitude,t[n].longitude)<=.15&&a++}return a}(e.position,e.parkingData);t>0?e.addAlertConfig("Parkings nearby already exist!",t+" parking(-s) within 150 meter already exist(-s). Are you sure you don't want to use already existings parking locations?",[{name:"ADD NEW PARKING!",action:function(){e.addNewParking(e.position)}}]):e.addNewParking(e.position)},variant:"text",color:"secondary",size:"large",startIcon:r.a.createElement(Ee.a,null)},"Add new parking")))),r.a.createElement(Wt,{position:window.google.maps.ControlPosition.BOTTOM_CENTER},r.a.createElement("div",null,r.a.createElement(S.a,{"aria-label":"delete",onClick:function(){if(!e.isLocked){var t=Object.assign({},e.position,{}),a=e.refInstance.current.getCenter();t.latitude=a.lat(),t.longitude=a.lng(),e.setPosition(t)}}},r.a.createElement(Ut.a,{fontSize:"large"})))),e.parkingData.map((function(t,n){var l=parseFloat(t.latitude),i=parseFloat(t.longitude);return console.log(Jt(t,e.selectedParkingData)),r.a.createElement(It.Marker,{key:t.parkingId,position:{lat:l,lng:i},icon:{url:Jt(t,e.selectedParkingData)?a(713):a(714),scaledSize:new window.google.maps.Size(20,48),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(10,35)},onClick:function(){if(!e.isLocked){var t=Object.assign({},e.parkingInfoWindows,{});t[n]=!0,e.setParkingInfoWindows(t)}}},e.parkingInfoWindows[n]&&r.a.createElement(It.InfoWindow,{onCloseClick:function(){var t=Object.assign({},e.parkingInfoWindows,{});t[n]=!1,e.setParkingInfoWindows(t)}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(j.a,{variant:"h6"},t.address),Jt(t,e.selectedParkingData)?r.a.createElement("div",null,r.a.createElement(Mt.a,{severity:"success"},'This parking location is already attached! See below in "Selected parking locations" section.')):r.a.createElement(be.a,{onClick:function(){e.addExistingParking(t)},variant:"text",color:"secondary",size:"large",startIcon:r.a.createElement(Ee.a,null)},"Add parking"))))})))}));function Jt(e,t){for(var a=0;a<t.length;a++)if(t[a].address===e.address)return!0;return!1}function Zt(e,t,a,n){var r=Xt(a-e),l=Xt(n-t),i=(e=Xt(e),a=Xt(a),Math.sin(r/2)*Math.sin(r/2)+Math.sin(l/2)*Math.sin(l/2)*Math.cos(e)*Math.cos(a));return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}function Xt(e){return e*Math.PI/180}var Qt=function(e){e.placeInfo;var t=e.locationMarker,a=e.setLocationMarker,l=e.addNewParking,i=e.addExistingParking,o=e.selectedParkingData,c=Object(n.useState)([]),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),g=f[0],b=f[1],h=Object(n.useState)(!1),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)(!1),j=Object(m.a)(O,2),C=j[0],S=(j[1],Object(n.useRef)(null)),k=je().addAlertConfig;return Object(n.useEffect)((function(){ge.Parking.getParkingByLocation("?lat="+t.latitude+"&lng="+t.longitude).then((function(e){d(e)})).catch((function(e){}))}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{isLocked:C,locationCallback:function(e){b(!0),a(e)}}),r.a.createElement($t,{loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"400px"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),mainInfoWindow:g,setMainInfoWindow:b,addNewParking:l,addExistingParking:i,parkingInfoWindows:v,setParkingInfoWindows:y,parkingData:u,position:t,setPosition:a,isLocked:C,refInstance:S,selectedParkingData:o,addAlertConfig:k}))};var ea=Me()((function(e){return{outline:{margin:e.spacing(1),padding:e.spacing(1),width:"100%"},button:{margin:e.spacing(2)},paper:{padding:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"8px"}}}))((function(e){var t=e.classes,a=e.locationData,n=e.setLocationData,l=e.allSelectedParkingData,i=e.setAllSelectedParkingData,o=e.placeInfo,c=Ie().addConfig;function s(e){for(var t=0;t<l.length;t++)if(l[t].address===e.address)return c(!1,"This parking is already attached!"),!0;return!1}var u=Object(pt.b)((function(e){var a=e.value;return r.a.createElement(G.a,{className:t.paper,elevation:3},r.a.createElement(j.a,null,a.address),r.a.createElement(S.a,{"aria-label":"delete",className:t.margin,onClick:function(){return i(l.filter((function(e){return e.parkingId!==a.parkingId})))}},r.a.createElement(V.a,{fontSize:"small"})))})),d=Object(pt.a)((function(e){var t=e.items;return r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement(u,{key:t,index:t,value:e})})))}));return r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Add parking"),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Select parking"),r.a.createElement(Qt,{selectedParkingData:l,placeInfo:o,locationMarker:a,setLocationMarker:n,addNewParking:function(e){s(e)||ge.Parking.insertNewParking([e]).then((function(e){i((function(t){return[].concat(Object(Ae.a)(t),[e[0]])})),c(!0)})).catch((function(e){c(!1)}))},addExistingParking:function(e){s(e)||i((function(t){return[].concat(Object(Ae.a)(t),[e])}))}}),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Selected parking locations"),0===l.length?r.a.createElement(Mt.a,{severity:"error"},"This place has no selected parking! To select parking for this place do the following:",r.a.createElement("br",null),"1. Select your current location or any other location",r.a.createElement("br",null),"2. Select already existing nearby parking locations and click add",r.a.createElement("br",null),"3. If none of the location is valid, click on the orange marker and add new parking"):r.a.createElement(d,{pressDelay:200,disableAutoscroll:!1,items:l,onSortEnd:function(e){var t=e.oldIndex,a=e.newIndex;i(Object(pt.c)(l,t,a))}}))})),ta=r.a.createContext({dialogConfig:null,dialogOpen:null,setDialogOpen:null,addEditDialogConfig:function(){},removeEditDialogConfig:function(){}}),aa={title:"Sample title",errorMessages:{},explanation:"Sample explanation",onCloseCallback:function(){},onDoneCallback:function(e){},textFieldLabel:"Type here",validateInput:function(e){return 0},defaultText:"",payload:{}};function na(e){var t=e.children,a=Object(n.useState)(aa),l=Object(m.a)(a,2),i=l[0],o=l[1],c=Object(n.useState)(!1),s=Object(m.a)(c,2),u=s[0],d=s[1],f={dialogConfig:i,dialogOpen:u,setDialogOpen:d,addEditDialogConfig:function(e){o(Object(p.a)(Object(p.a)({},aa),e)),d(!0)},removeEditDialogConfig:function(){return o(null)}};return r.a.createElement(ta.Provider,{value:f},t)}function ra(){var e=Object(n.useContext)(ta);return{dialogConfig:e.dialogConfig,addEditDialogConfig:e.addEditDialogConfig,removeEditDialogConfig:e.removeEditDialogConfig,dialogOpen:e.dialogOpen,setDialogOpen:e.setDialogOpen}}var la=a(417);var ia=Me()((function(e){return{outline:{margin:e.spacing(1),padding:e.spacing(1),width:"100%"},button:{margin:e.spacing(2)},paper:{padding:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"8px"},slider:{flex:1,marginRight:10},sliderContainer:{display:"flex",flexDirection:"row"},sliderInput:{}}}))((function(e){var t=e.classes,a=e.selectedTags,l=e.setSelectedTags,i=e.selectedCategories,o=e.setSelectedCategories,c=e.placeInfo,s=e.setPlaceInfo,u=Object(n.useState)([]),d=Object(m.a)(u,2),f=d[0],g=d[1],b=Object(n.useState)([]),h=Object(m.a)(b,2),E=h[0],v=h[1],y=c.grade,O=function(e){s((function(t){return Object(p.a)(Object(p.a)({},t),{},{grade:e})}))},C=ra().addEditDialogConfig,S=Ie().addConfig;return Object(n.useEffect)((function(){ge.Tags.getAllTags().then((function(e){v(e)})).catch((function(e){console.log(e)})),ge.Categories.getAllCategories().then((function(e){g(e)})).catch((function(e){console.log(e)}))}),[]),r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Place discovery settings"),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Select tags"),r.a.createElement(Re,{label:"Select tags",id:"tagId",options:E,setOptions:v,selectedOptions:a,setSelectedOptions:l}),r.a.createElement(be.a,{variant:"text",color:"primary",size:"small",className:t.button,onClick:function(){C({title:"Add tag",explanation:"Type the tag name",onDoneCallback:function(e){ge.Tags.addTag([{name:e}]).then((function(t){var n={tagId:t[0],name:e};v([].concat(Object(Ae.a)(E),[n])),l([].concat(Object(Ae.a)(a),[n]))})).catch((function(){S(!1,"Failed to add tag.")}))},errorMessages:{1:"The tag name is too short",2:"A tag with identical name already exists. You should choose the existing tag instead"},validateInput:function(e){return e.length<0?1:0!==E.filter((function(t){return t.name===e})).length?2:0},textFieldLabel:"Warm, quick, cozy..."})},startIcon:r.a.createElement(Ee.a,null)},"Add missing tag"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Select categories"),r.a.createElement(Re,{label:"Select categories",id:"categoryId",options:f,setOptions:g,selectedOptions:i,setSelectedOptions:o}),r.a.createElement(be.a,{variant:"text",color:"primary",size:"small",className:t.button,onClick:function(){C({title:"Add category",explanation:"Type the category name",onDoneCallback:function(e){ge.Categories.addCategory([{name:e}]).then((function(t){var a={categoryId:t[0],name:e};g([].concat(Object(Ae.a)(f),[a])),o([].concat(Object(Ae.a)(i),[a]))})).catch((function(e){S(!1,"Failed to add category.")}))},errorMessages:{1:"The category name is too short",2:"A category with identical name already exists. You should choose the existing category instead"},validateInput:function(e){return e.length<0?1:0!==f.filter((function(t){return t.name===e})).length?2:0},textFieldLabel:"Restaurant, hotel, hiking..."})},startIcon:r.a.createElement(Ee.a,null)},"Add missing category"),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"subtitle1"},"Grade this place"),r.a.createElement("div",{className:t.sliderContainer},r.a.createElement(tt.a,{className:t.slider,value:y,onChange:function(e,t){O(t)},max:100,min:0,"aria-labelledby":"input-slider"}),r.a.createElement(la.a,{className:t.sliderInput,value:y,margin:"dense",onChange:function(e){O(""===e.target.value?"":Number(e.target.value))},onBlur:function(){y<0?O(0):y>100&&O(100)},inputProps:{step:1,min:0,max:100,type:"number","aria-labelledby":"input-slider"}})))})),oa=a(791),ca=a(100),sa=a.n(ca),ua=a(825),da=a(798),ma=Object(g.a)({root:{minWidth:275,width:"20%",padding:"2px",marginRight:"16px"}});function pa(e){var t=e.review,a=ma();return r.a.createElement(bt.a,{className:a.root,variant:"outlined"},r.a.createElement(da.a,null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(zt.a,{alt:"Cindy Baker",src:t.photoUrl?t.photoUrl:"/broken-image.jpg"}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"8px"}},r.a.createElement(j.a,{title:"subtitle1"},t.name," ",t.surname),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(ua.a,{size:"small",name:"read-only",value:t.rating,readOnly:!0}),r.a.createElement(j.a,{title:"subtitle1"},"+"+t.upvotes)))),r.a.createElement(j.a,{title:"subtitle1"},Fe()(t.timeAdded).format("LL")),r.a.createElement("div",{style:{marginTop:"16px"}},t.title),r.a.createElement(j.a,{title:"subtitle1"},t.review)))}var fa=a(140),ga=a.n(fa),ba=a(214),ha=a.n(ba),Ea=a(799),va=a(733),ya=a(826),Oa=a(813);var ja=Me()((function(e){return{reviewsInfo:{display:"flex"},reviews:{display:"flex",width:"100%",margin:e.spacing(2),overflowX:"scroll"},sortingButtons:{padding:e.spacing(2)}}}))((function(e){var t=e.classes,a=e.placeInfo,l=Object(n.useState)([]),i=Object(m.a)(l,2),o=i[0],c=i[1],s=Object(n.useState)(!0),u=Object(m.a)(s,2),d=u[0],p=u[1],f=Object(n.useState)(1),g=Object(m.a)(f,2),b=(g[0],g[1]),h=r.a.useState(null),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Boolean(v),C=O?"simple-popover":void 0,k=Object(n.useState)("mostRated"),I=Object(m.a)(k,2),x=I[0],w=I[1];function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"?p="+a.placeId;ge.Reviews.getPlaceReviews(e).then((function(e){c((function(t){return[].concat(Object(Ae.a)(t),Object(Ae.a)(e.list))})),p(!1)})).catch((function(e){p(!1)}))}Object(n.useEffect)((function(){P("?p="+a.placeId+"&page=1&o="+x)}),[x]);var T=ga()((function(e){return function(e){Math.round(e.target.scrollWidth-e.target.scrollLeft-0)<=e.target.clientWidth&&!d&&o.length>0&&o.length<a.totalReviews&&(p(!0),b((function(e){return P("?p="+a.placeId+"&page="+(e+1)+"&o="+x),e+1})))}(e)}),200),A=function(){y(null)};return r.a.createElement("div",null,r.a.createElement(j.a,{variant:"h6"},"Reviews",r.a.createElement("br",null),o.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",{className:t.reviewsInfo},r.a.createElement(ua.a,{name:"read-only",value:a.overallStarRating,precision:.2,readOnly:!0}),r.a.createElement(j.a,{style:{marginLeft:"8px"},variant:"subtitle1"},a.totalReviews," reviews")),r.a.createElement(Ea.a,{"aria-describedby":C,title:"Filter list"},r.a.createElement(S.a,{"aria-label":"filter list",onClick:function(e){y(e.currentTarget)}},r.a.createElement(ha.a,null))),r.a.createElement(va.a,{id:C,open:O,anchorEl:v,onClose:A,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(ya.a,{className:t.sortingButtons,"aria-label":"gender",value:x,name:"gender1",onChange:function(e){var t=e.target,a=(t.name,t.value);w(a),c([]),b(1),A()}},r.a.createElement(xe.a,{value:"mostRated",control:r.a.createElement(Oa.a,null),label:"Most rated"}),r.a.createElement(xe.a,{value:"newest",control:r.a.createElement(Oa.a,null),label:"Newest"})))),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(j.a,null,"Showing: ",o.length," out of ",a.totalReviews),r.a.createElement(j.a,null,"Sorting by: ",x)),r.a.createElement("div",{className:t.reviews,onScroll:function(e){return function(e){e.persist(),T(e)}(e)}},o.map((function(e){return r.a.createElement(pa,{review:e})})))):r.a.createElement(j.a,null," No reviews for this place")),r.a.createElement("br",null),d?r.a.createElement(Z.a,null):null)})),Ca=r.a.createContext({title:"",setTitle:function(){}});function Sa(e){var t=e.children,a=Object(n.useState)("Home"),l=Object(m.a)(a,2),i=l[0],o=l[1],c={title:i,setTitle:function(e){return o(e)}};return r.a.createElement(Ca.Provider,{value:c},t)}function ka(){var e=Object(n.useContext)(Ca);return{title:e.title,setTitle:e.setTitle}}var Ia=a(732);var xa=Me()((function(e){return{root:{margin:e.spacing(2),display:"flex",flexDirection:"column"},textField:{marginTop:16},formControl:{margin:e.spacing(1),minWidth:120}}}))((function(e){var t=e.classes,a=e.open,l=e.setOpen,i=e.addCallback,o=Ie().addConfig,c=je().addAlertConfig,s=Object(n.useState)({name:"",subtitle:"",description:"",type:"1"}),u=Object(m.a)(s,2),d=u[0],f=u[1],g=Object(n.useState)({name:!1,subtitle:!1,description:!1}),b=Object(m.a)(g,2),h=b[0],E=b[1],v=Object(n.useState)(!1),y=Object(m.a)(v,2),O=y[0],j=y[1],C=function(e){var t=e.target,a=t.name,n=t.value,r=Object(p.a)({},d);r[a]=n,f(r)};function S(){(function(){var e=Object.assign({},h),t=!1;for(var a in d)e[a]=""===d[a]||-1===d[a],!0===e[a]&&(t=!0);return E(e),t})()||(j(!0),c("Add new recommendation","Are you sure you want to add this recommendation?",[{name:"Yes",action:function(){j(!0),ge.Recommendation.createRecommendation(d).then((function(e){var t=Object(p.a)({},d);t.id=e,o(!0,"Recommendation added successfully"),i(t),l(!1)})).catch((function(e){console.log("recommendation error",e),o(!1,"Something went wrong. Please try again.")})).finally((function(){j(!1)}))}}]))}return r.a.createElement(ot.a,{open:a,fullWidth:!0,maxWidth:"md",onClose:function(){l(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},O?r.a.createElement(Z.a,null):null,r.a.createElement(st.a,{id:"alert-dialog-title"},"Add new recommendation"),r.a.createElement(ut.a,null,r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{id:"outlined-basic",error:h.title,required:!0,label:"Title",name:"name",value:d.name,onChange:C,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,error:h.subtitle,label:"Subtitle",name:"subtitle",value:d.subtitle,onChange:C,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,error:h.description,label:"Description",name:"description",value:d.description,onChange:C,variant:"outlined",className:t.textField}),r.a.createElement(rt.a,{component:"fieldset",style:{marginTop:32}},r.a.createElement(Ia.a,{component:"legend"},"Recommendation type"),r.a.createElement(ya.a,{"aria-label":"rec",name:"rec1",value:d.type,onChange:function(e){var t=Object(p.a)({},d);t.type=e.target.value,f(t)}},r.a.createElement(xe.a,{value:"1",control:r.a.createElement(Oa.a,null),label:"Places recommendation"}),r.a.createElement(xe.a,{value:"2",control:r.a.createElement(Oa.a,null),label:"Tours recommendation"}))))),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return l(!1)},color:"primary"},"Close"),r.a.createElement(be.a,{color:"primary",onClick:function(){S()}},"Create recommendation")))})),wa=a(394),Pa=a.n(wa),Ta=a(800);var Aa=Me()((function(e){return{root:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start"}}}))((function(e){var t=e.classes,a=e.open,l=e.setOpen,i=e.objectId,o=e.type,c=Ie().addConfig,s=(je().addAlertConfig,Object(n.useState)([])),u=Object(m.a)(s,2),d=u[0],p=u[1],f=Object(n.useState)({pageNum:1}),g=Object(m.a)(f,2),b=g[0],h=g[1],E=Object(n.useState)(!1),v=Object(m.a)(E,2),y=v[0],j=v[1],S=Object(n.useState)(!1),k=Object(m.a)(S,2),I=k[0],x=k[1],w=Object(n.useState)(""),P=Object(m.a)(w,2),T=P[0],N=P[1];function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ge.Recommendation.getAllRecommendations("?p="+e+"&keyword="+T+"&type="+o).then((function(e){p(t?e.list:function(t){return[].concat(Object(Ae.a)(t),Object(Ae.a)(e.list))}),delete e.list,h(e)})).catch().finally((function(){j(!1)}))}var L=ga()((function(e){return function(e){console.log("Handle scroll");Math.round(e.target.scrollHeight-e.target.scrollTop-0)<=e.target.clientHeight&&!y&&d.length>0&&b.pageNum<b.pages&&(j(!0),console.log("Requesting new page"),R(b.pageNum+1))}(e)}),200);return Object(n.useEffect)((function(){console.log("Keyword changed"),R(1,!0)}),[T]),r.a.createElement(ot.a,{open:a,fullWidth:!0,maxWidth:"sm",onClose:function(){l(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},y?r.a.createElement(Z.a,null):null,r.a.createElement(st.a,{id:"alert-dialog-title"},"Add to recommendation"),r.a.createElement(ut.a,null,r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{id:"standard-search",label:"Search field",value:T,type:"search",onChange:function(e){N(e.target.value)}}),d.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{component:"nav",style:{overflowY:"scroll",width:"100%",maxHeight:400},onScroll:function(e){e.persist(),L(e)},"aria-label":"main mailbox folders"},d.map((function(e){return r.a.createElement(A.a,{key:e.name,style:{width:"100%"},button:!0,onClick:function(){var t;t=e,ge.Recommendation.addObjectToRecommendation({id:i,recommendationId:t.id}).then((function(){c(!0,"Added object to recommendation successfully!")})).catch((function(){c(!0,"Failed to add!")})).finally((function(){l(!1)}))}},r.a.createElement(Ta.a,null,r.a.createElement(Pa.a,null)),r.a.createElement(D.a,{primary:e.name}))})))):r.a.createElement(Mt.a,{severity:"info"},"Recommendations list is empty. You can add new recommendation below.")),r.a.createElement(C.a,{style:{width:"100%"}}),r.a.createElement(be.a,{onClick:function(){return x(!0)},variant:"text",color:"secondary",size:"large",startIcon:r.a.createElement(Ee.a,null)},"Create new recommendation")),r.a.createElement(xa,{open:I,setOpen:x,addCallback:function(e){var t=Object(Ae.a)(d);t.unshift(e),p(t)}})),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return l(!1)},color:"primary"},"Close")))})),Da=a(803),Na=a(264),Ra=a.n(Na);function La(e){var t=e.categories;return null!=t&&r.a.createElement(ve.a,{component:"ul",style:{display:"flex",justifyContent:"left",flexWrap:"wrap",listStyle:"none",padding:"0px"}},t.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(Ne.a,{variant:"outlined",style:{margin:"5px"},label:e.name}))})))}function Ma(e){var t=e.city,a=e.address,l=e.priceRange,i=e.rating;return r.a.createElement("div",null,null!=i&&r.a.createElement(n.Fragment,null,r.a.createElement(ua.a,{readOnly:!0,value:i}),r.a.createElement("br",null)),(null!=a?a:"")+" "+(null!=t?t:"")," ",r.a.createElement("div",{style:{color:"green"}},l))}var _a=Me()((function(e){return{root:{},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:Ra.a[500]}}}))((function(e){var t,a=e.classes,n=e.placeData,l=e.renderActionArea;return r.a.createElement(bt.a,{className:a.root},r.a.createElement(Da.a,{action:null!=l&&l(),title:n.name,subheader:r.a.createElement(Ma,{city:n.city,address:n.address,priceRange:n.priceRange,rating:n.overallStarRating})}),null!=n.photos&&n.photos.length>0&&r.a.createElement(gt.a,{className:a.media,image:n.photos[0].url}),r.a.createElement(da.a,null,r.a.createElement(j.a,{variant:"body2",color:"textSecondary",component:"p"},null==(t=n.description)?"":t.length>500?t.substring(0,500)+"...":t),r.a.createElement(La,{categories:n.categories}),r.a.createElement(j.a,{variant:"body2",color:"textSecondary",component:"p"},n.website)),r.a.createElement(ht.a,{disableSpacing:!0}))})),Fa=1,Ha=2;var qa=Object(L.a)((function(e){return{paperContent:{marginTop:e.spacing(4),width:"100%",padding:e.spacing(2)}}}))((function(e){var t=e.classes,a=e.recommendation,l=e.onEditCallback;return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(Ne.a,{label:1===a.type?"Place recommendation":"Tour recommendation"}),r.a.createElement(j.a,{variant:"h6"},a.name),r.a.createElement(j.a,{variant:"subtitle1"},a.subtitle),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",overflowX:"auto",width:"100%"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},a.objects.length>0?a.objects.map((function(e,t){return delete e.description,r.a.createElement("div",{style:{width:300,padding:16}},r.a.createElement(_a,{placeData:e}))})):r.a.createElement(Mt.a,{severity:"info"},"This recommendation does not have any objects attached. You can attach Places or Tours by browsing in Places and Tours tables"))),r.a.createElement(n.Fragment,null,r.a.createElement(be.a,{style:{marginTop:16},variant:"outlined",color:"primary",onClick:function(){return l()},className:t.button},"Edit")))})),Wa=a(804),Ba=a(811),Ua=a(820);var za=Me()((function(e){return{root:{width:"100%",marginTop:5},intervalContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:0,flexWrap:"wrap"},pickerStyle:{width:50,marginLeft:3,margin:0}}}))((function(e){var t=e.classes,a=e.scheduleData,n=e.setScheduleData,l=e.scheduleOpenIndex,i=e.variantId,o=e.enableLastAccommodation,c=a[l],s=c.variants.find((function(e){return e.elementId===i})),u=s.shifts.map((function(e,a){var l=a!==s.shifts.length-1,u=0===a;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.intervalContainer},r.a.createElement(j.a,{variant:"h7"},u?"O":"o","pens at"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,className:t.pickerStyle,format:"HH:mm",value:Fe()(e.openTime,"HH:mm"),onChange:function(t){return a=e.elementId,r=t,void n((function(e){var t=Object(Ae.a)(e);return c.variants.find((function(e){return e.elementId===i})).shifts.find((function(e){return e.elementId===a})).openTime=Fe()(r).format("HH:mm"),t}));var a,r}}),r.a.createElement(j.a,{variant:"h7"},"and closes at"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,className:t.pickerStyle,format:"HH:mm",value:Fe()(e.closeTime,"HH:mm"),onChange:function(t){return a=e.elementId,r=t,void n((function(e){var t=Object(Ae.a)(e);return c.variants.find((function(e){return e.elementId===i})).shifts.find((function(e){return e.elementId===a})).closeTime=Fe()(r).format("HH:mm"),t}));var a,r}}),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"h7"},"last accommodation at"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,className:t.pickerStyle,format:"HH:mm",value:Fe()(e.lastAccommodation,"HH:mm"),onChange:function(t){return a=e.elementId,r=t,void n((function(e){var t=Object(Ae.a)(e);return c.variants.find((function(e){return e.elementId===i})).shifts.find((function(e){return e.elementId===a})).lastAccommodation=Fe()(r).format("HH:mm"),t}));var a,r}}))),l&&r.a.createElement(j.a,{variant:"h7",style:{marginRight:5}},"THEN"))}));return r.a.createElement("div",{className:t.root},u,r.a.createElement(xe.a,{control:r.a.createElement(we.a,{name:"checkedB",color:"primary",checked:s.shifts.length>1,onChange:function(){s.shifts.length>1?n((function(e){for(var t=Object(Ae.a)(e),a=t[l].variants.find((function(e){return i===e.elementId})).shifts;a.length>1;)a.pop();return t})):n((function(e){var t=Object(Ae.a)(e),a={openTime:"08:00",closeTime:"18:00",elementId:et.a.generate()};return o&&(a.lastAccommodation="18:00"),t[l].variants.find((function(e){return i===e.elementId})).shifts.push(a),t}))}}),label:"Split schedule"}))})),Ga=a(216),Ya=a.n(Ga),Va=[{id:0,name:"Mon",fullName:"Monday"},{id:1,name:"Tue",fullName:"Tuesday"},{id:2,name:"Wed",fullName:"Wednesday"},{id:3,name:"Thu",fullName:"Thursday"},{id:4,name:"Fri",fullName:"Friday"},{id:5,name:"Sat",fullName:"Saturday"},{id:6,name:"Sun",fullName:"Sunday"}];Me()((function(e){return{root:{flex:1,marginTop:10,border:"1px dashed black",padding:8},weekdayPickerContainer:{display:"flex",width:"100%"},weekdayButton:{flex:1,margin:5,padding:0,minHeight:0,minWidth:0},removeButtonContainer:{display:"flex",justifyContent:"flex-end"}}}))((function(e){var t=e.classes,a=e.enableLastAccommodation,n=e.scheduleData,l=e.setScheduleData,i=e.scheduleOpenIndex,o=e.variantId,c=n[i],s=c.variants.filter((function(e){return e.elementId===o}))[0],u=r.a.createElement("div",{className:t.weekdayPickerContainer},Va.map((function(e){var a,n=s.days.some((function(t){return t===e.id}));return r.a.createElement(be.a,{onClick:function(){return t=e.id,void l((function(e){var a=Object(Ae.a)(e),n=a[i].variants.find((function(e){return e.elementId===o})).days;return n.includes(t)?n.splice(n.indexOf(t),1):n.push(t),a}));var t},className:t.weekdayButton,variant:"contained",color:n?"primary":"secondary",disabled:!n&&(a=e.id,c.variants.some((function(e){return e.days.includes(a)})))},e.name)})));return r.a.createElement("div",{className:t.root},u,r.a.createElement(za,{enableLastAccommodation:a,scheduleData:n,scheduleOpenIndex:i,setScheduleData:l,variantId:o}),r.a.createElement("div",{className:t.removeButtonContainer},r.a.createElement(be.a,{variant:"text",color:"primary",size:"large",onClick:function(){l((function(e){var t=Object(Ae.a)(e),a=t[i].variants;return a.splice(a.findIndex((function(e){return e.elementId===o})),1),t}))},startIcon:r.a.createElement(Ya.a,null),style:{display:"absolute"}},"Remove this variant")))}));var Ka=[{id:0,name:"Mon",fullName:"Monday"},{id:1,name:"Tue",fullName:"Tuesday"},{id:2,name:"Wed",fullName:"Wednesday"},{id:3,name:"Thu",fullName:"Thursday"},{id:4,name:"Fri",fullName:"Friday"},{id:5,name:"Sat",fullName:"Saturday"},{id:6,name:"Sun",fullName:"Sunday"}],$a=function(){return{openTime:"08:00",closeTime:"18:00",elementId:et.a.generate()}};var Ja=Me()((function(e){return{root:{flex:1,marginTop:10,border:"1px dashed black",padding:8},weekdayPickerContainer:{display:"flex",width:"100%"},weekdayButtonContainer:{flex:1,padding:0,minHeight:0,minWidth:0},button:{flex:1,margin:5,padding:0,minHeight:0,minWidth:0,width:"90%"},intervalContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",margin:0,flexWrap:"wrap"},pickerStyle:{width:35,marginLeft:3,margin:0},pickerInput:{fontSize:13,padding:0}}}))((function(e){var t=e.schedule,a=e.setSchedule,n=e.scheduleOpenIndex,l=e.classes;return r.a.createElement("div",null,r.a.createElement("div",{className:l.root},r.a.createElement("div",{className:l.weekdayPickerContainer},Ka.map((function(e,i){var o,c=(o=i,t[n].periods.filter((function(e){return e.openDay===o}))),s=c.length>1;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l.weekdayButtonContainer},r.a.createElement(be.a,{variant:"contained",color:0!==c.length?"primary":"secondary",className:l.button,onClick:function(){c.length>0?a((function(e){var t=Object(Ae.a)(e);return t[n].periods=t[n].periods.filter((function(e){return e.openDay!==i})),t})):a((function(e){var t=Object(Ae.a)(e);return t[n].periods.push(Object(p.a)(Object(p.a)({},$a()),{},{openDay:i})),t}))}},e.name),c.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l.intervalContainer},r.a.createElement(Ua.a,{margin:"normal",ampm:!1,className:l.pickerStyle,format:"HH:mm",minutesStep:5,InputProps:{classes:{input:l.pickerInput}},value:Fe()(e.openTime,"HH:mm"),onChange:function(t){return function(e,t){a((function(a){var r=Object(Ae.a)(a);return r[n].periods.find((function(t){return t.elementId===e})).openTime=Fe()(t).format("HH:mm"),r}))}(e.elementId,t)}}),r.a.createElement(j.a,{variant:"h7"},"-"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,className:l.pickerStyle,format:"HH:mm",minutesStep:5,InputProps:{classes:{input:l.pickerInput}},value:Fe()(e.closeTime,"HH:mm"),onChange:function(t){return function(e,t){a((function(a){var r=Object(Ae.a)(a);return r[n].periods.find((function(t){return t.elementId===e})).closeTime=Fe()(t).format("HH:mm"),r}))}(e.elementId,t)}})))})),0!==c.length&&r.a.createElement(xe.a,{style:{width:"100%"},control:r.a.createElement(we.a,{name:"checkedB",color:"primary",checked:s,onChange:function(){a(s?function(e){var t=Object(Ae.a)(e),a=t[n].periods.filter((function(e){return e.openDay===i})).pop();return t[n].periods=t[n].periods.filter((function(e){return e.elementId!=a.elementId})),t}:function(e){var t=Object(Ae.a)(e);return t[n].periods.push(Object(p.a)(Object(p.a)({},$a()),{},{openDay:i})),t})}}),label:r.a.createElement("span",{style:{fontSize:13}},"Split")})),r.a.createElement(C.a,{orientation:"vertical",flexItem:!0}))})))),r.a.createElement(j.a,{variant:"h7"},"Global time"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,format:"HH:mm",className:l.pickerStyle,minutesStep:5,InputProps:{classes:{input:l.pickerInput}},onChange:function(e){a((function(t){for(var a=Object(Ae.a)(t),r=[],l=function(a){var l=t[n].periods.filter((function(e){return e.openDay===a}));l.length>0&&(r.push(Object(p.a)(Object(p.a)({},l[0]),{},{openTime:Fe()(e).format("HH:mm")})),l.length>1&&r.push(l[1]))},i=0;i<7;i++)l(i);return a[n].periods=r,a}))},value:null==t[n].periods||0===t[n].periods.length?Fe()("18:00","HH:mm"):Fe()(t[n].periods[0].openTime,"HH:mm")}),r.a.createElement(j.a,{variant:"h7"},"-"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,format:"HH:mm",className:l.pickerStyle,minutesStep:5,InputProps:{classes:{input:l.pickerInput}},onChange:function(e){a((function(t){for(var a=Object(Ae.a)(t),r=[],l=function(a){var l=t[n].periods.filter((function(e){return e.openDay===a}));l.length>0&&(r.push(Object(p.a)(Object(p.a)({},l[0]),{},{closeTime:Fe()(e).format("HH:mm")})),l.length>1&&r.push(l[1]))},i=0;i<7;i++)l(i);return a[n].periods=r,a}))},value:null==t[n].periods||0===t[n].periods.length?Fe()("08:00","HH:mm"):Fe()(t[n].periods[0].closeTime,"HH:mm")}),r.a.createElement("br",null),r.a.createElement(j.a,{variant:"h7"},"Global split schedule time"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,format:"HH:mm",className:l.pickerStyle,minutesStep:5,InputProps:{classes:{input:l.pickerInput}},onChange:function(e){a((function(t){for(var a=Object(Ae.a)(t),r=[],l=function(a){var l=t[n].periods.filter((function(e){return e.openDay===a}));l.length>0&&(r.push(l[0]),l.length>1&&r.push(Object(p.a)(Object(p.a)({},l[1]),{},{openTime:Fe()(e).format("HH:mm")})))},i=0;i<7;i++)l(i);return a[n].periods=r,a}))},value:function(){for(var e=function(e){var a=t[n].periods.filter((function(t){return t.openDay===e}));if(a.length>1)return{v:Fe()(a[1].openTime,"HH:mm")}},a=0;a<7;a++){var r=e(a);if("object"===typeof r)return r.v}return Fe()("13:00","HH:mm")}()}),r.a.createElement(j.a,{variant:"h7"},"-"),r.a.createElement(Ua.a,{margin:"normal",ampm:!1,format:"HH:mm",className:l.pickerStyle,minutesStep:5,InputProps:{classes:{input:l.pickerInput}},onChange:function(e){a((function(t){for(var a=Object(Ae.a)(t),r=[],l=function(a){var l=t[n].periods.filter((function(e){return e.openDay===a}));l.length>0&&(r.push(l[0]),l.length>1&&r.push(Object(p.a)(Object(p.a)({},l[1]),{},{closeTime:Fe()(e).format("HH:mm")})))},i=0;i<7;i++)l(i);return a[n].periods=r,a}))},value:function(){for(var e=function(e){var a=t[n].periods.filter((function(t){return t.openDay===e}));if(a.length>1)return{v:Fe()(a[1].closeTime,"HH:mm")}},a=0;a<7;a++){var r=e(a);if("object"===typeof r)return r.v}return Fe()("18:00","HH:mm")}()}))}));var Za=Me()((function(e){return{root:{flex:1,marginTop:10,width:"100%"},scheduleDateContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",flexWrap:"wrap"},pickerStyle:{width:100,padding:5}}}))((function(e){var t=e.classes,a=e.scheduleData,n=e.setScheduleData,l=e.scheduleOpenIndex,i=e.setScheduleOpenIndex,o=e.seasonalScheduleEnabled,c=a[l],s=r.a.createElement("div",{className:t.scheduleDateContainer},r.a.createElement(j.a,{variant:"h8"},"This schedule applies from"),r.a.createElement(Te.a,{className:t.pickerStyle,views:["month","date"],value:Fe()(c.from,"MM-DD"),onChange:function(e,t){n((function(t){var a=Object(Ae.a)(t);return a[l].from=Fe()(e).format("MM-DD"),a}))}}),r.a.createElement(j.a,{variant:"h8"},"to"),r.a.createElement(Te.a,{className:t.pickerStyle,views:["month","date"],value:Fe()(c.to,"MM-DD"),onChange:function(e,t){n((function(t){var a=Object(Ae.a)(t);return a[l].to=Fe()(e).format("MM-DD"),a}))}}));return r.a.createElement("div",{className:t.root},o&&s,0!==l&&r.a.createElement(be.a,{variant:"text",color:"primary",size:"large",onClick:function(){i((function(e){return n((function(t){return Object(Ae.a)(t).filter((function(t,a){return e!==a}))})),e-1}))},startIcon:r.a.createElement(Ya.a,null),style:{display:"absolute"}},"Remove this schedule"),r.a.createElement(Ja,{schedule:a,setSchedule:n,scheduleOpenIndex:l}))})),Xa=[{from:"01-25",to:"02-20",periods:[{openTime:"08:00",closeTime:"18:00",openDay:0,elementId:et.a.generate()},{openTime:"08:00",closeTime:"18:00",openDay:1,elementId:et.a.generate()},{openTime:"08:00",closeTime:"18:00",openDay:2,elementId:et.a.generate()},{openTime:"08:00",closeTime:"18:00",openDay:3,elementId:et.a.generate()},{openTime:"08:00",closeTime:"18:00",openDay:4,elementId:et.a.generate()},{openTime:"08:00",closeTime:"17:00",openDay:5,elementId:et.a.generate()}]}];var Qa=Me()((function(e){return{root:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start"},tabContainer:{width:"100%",display:"flex",flexDirection:"row"},tabsLayout:{flex:9},addScheduleButtonContainer:{flex:1,display:"flex",justifyContent:"center",alignItems:"center"},header:{display:"flex",width:"100%",justifyContent:"space-between"}}}))((function(e){var t=e.classes,a=e.scheduleData,n=e.setScheduleData,l=e.scheduleOpenIndex,i=e.setScheduleOpenIndex,o=e.seasonalScheduleEnabled,c=e.setSeasonalScheduleEnabled,s=e.isScheduleEnabled,u=e.setIsScheduleEnabled,d=e.lastAccommodation,m=e.setLastAccommodation,f=r.a.createElement("div",{className:t.tabContainer},r.a.createElement(Ba.a,{value:l,onChange:function(e,t){return i(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth",className:t.tabsLayout},a.map((function(e,t){return r.a.createElement(Wa.a,{onClick:function(){return i(t)},label:"".concat(Fe()(e.from,"MM-DD").format("MMMM "),"-").concat(Fe()(e.to,"MM-DD").format("MMMM "))})}))),r.a.createElement("div",{className:t.addScheduleButtonContainer},r.a.createElement(S.a,{onClick:function(){n((function(e){var t=Object(Ae.a)(e);return t.push({from:"01-01",to:"05-01",periods:Object(Ae.a)(Xa[0].periods)}),i(t.length-1),t}))},variant:"text",color:"secondary",size:"large"},r.a.createElement(Ee.a,null))));return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.header},r.a.createElement(j.a,{variant:"h6"},"Working hours"),r.a.createElement(xe.a,{control:r.a.createElement(Lt.a,{checked:s,onChange:function(){return u((function(e){return!e}))},color:"primary"}),label:"Enable schedule for this place?"})),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(xe.a,{control:r.a.createElement(we.a,{checked:o,onChange:function(){var e=!o;c((function(){return i(0),e})),e&&n((function(e){return Object(Ae.a)(e).map((function(e){return Object(p.a)(Object(p.a)({},e),{},{from:"01-01",to:"02-01"})}))}))},name:"checkedB",color:"primary"}),label:"Enable seasonal schedule"}),r.a.createElement(xe.a,{control:r.a.createElement(we.a,{name:"checkedB",color:"primary",checked:null!=d,onChange:function(){m(null!=d?null:30)}}),label:"Specify last accommodation times"}),null!=d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{id:"standard-number",label:"Minutes to closing time",type:"number",InputLabelProps:{shrink:!0},value:d,onChange:function(e){return m(e.target.value)}})),o&&f,r.a.createElement(Za,{scheduleData:a,seasonalScheduleEnabled:o,setScheduleData:n,scheduleOpenIndex:l,setScheduleOpenIndex:i})))}));var en=Object(L.a)((function(e){var t,a,n;return{button:{margin:e.spacing(2)},paperContent:(t={marginTop:e.spacing(4)},Object(d.a)(t,e.breakpoints.down("lg"),{width:"95%",padding:e.spacing(2)}),Object(d.a)(t,e.breakpoints.up("lg"),{width:"70%",padding:e.spacing(4)}),t),root:Object(d.a)({height:"100vh"},e.breakpoints.down("lg"),{height:"100%"}),loader:{display:"flex",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh"},content:(a={display:"flex",flexDirection:"column",alignItems:"center",height:"calc(93vh - 64px)"},Object(d.a)(a,e.breakpoints.down("lg"),{width:"100%",padding:e.spacing(1)}),Object(d.a)(a,e.breakpoints.up("lg"),{width:"auto",padding:e.spacing(8)}),Object(d.a)(a,"overflowY","auto"),a),bottom:(n={},Object(d.a)(n,e.breakpoints.down("lg"),{position:"fixed",height:"7vh",bottom:0,right:0}),Object(d.a)(n,"width","100%"),Object(d.a)(n,"zIndex",5),Object(d.a)(n,"display","flex"),Object(d.a)(n,"alignItems","center"),Object(d.a)(n,"justifyContent","space-around"),Object(d.a)(n,"padding",e.spacing(1)),n)}}))((function(e){var t=e.classes,a=e.match,l=Object(n.useState)({placeId:"",name:"",description:"",website:"",phoneNumber:"",isPublic:!1,isVerified:!0,overallStarRating:0,totalReviews:0,source:"",price:"",averageTimeSpent:"0",grade:50}),i=Object(m.a)(l,2),o=i[0],c=i[1],s=Object(n.useState)([]),u=Object(m.a)(s,2),d=u[0],f=u[1],g=Object(n.useState)([]),b=Object(m.a)(g,2),h=b[0],E=b[1],v=Object(n.useState)(Xa),y=Object(m.a)(v,2),O=y[0],j=y[1],C=Object(n.useState)(0),S=Object(m.a)(C,2),k=S[0],I=S[1],x=Object(n.useState)(!1),w=Object(m.a)(x,2),P=w[0],T=w[1],A=Object(n.useState)(null),D=Object(m.a)(A,2),N=D[0],R=D[1],M=Object(n.useState)([]),_=Object(m.a)(M,2),F=_[0],H=_[1],q=Object(n.useState)({city:"",address:"",country:"",latitude:54.687157,longitude:25.279652,county:"",municipality:""}),W=Object(m.a)(q,2),B=W[0],U=W[1],z=Object(n.useState)({city:"",address:"",country:"",latitude:54.687157,longitude:25.279652,county:"",municipality:""}),Y=Object(m.a)(z,2),V=Y[0],K=Y[1],$=Object(n.useState)([]),J=Object(m.a)($,2),X=J[0],Q=J[1],ee=Object(n.useState)([]),te=Object(m.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(!1),le=Object(m.a)(re,2),ie=le[0],oe=le[1],ce=Object(n.useState)(a.params.placeId),se=Object(m.a)(ce,2),ue=se[0],de=se[1],me=Object(n.useState)(!0),pe=Object(m.a)(me,2),fe=pe[0],he=pe[1],Ee=Object(n.useState)(!1),ve=Object(m.a)(Ee,2),ye=ve[0],Oe=ve[1],Se=Object(n.useState)({name:!1}),ke=Object(m.a)(Se,2),we=ke[0],Pe=ke[1],Te=Object(n.useState)(!1),Ae=Object(m.a)(Te,2),De=Ae[0],Ne=(Ae[1],Object(n.useState)(!1)),Re=Object(m.a)(Ne,2),Le=Re[0],Me=Re[1],_e=Ie().addConfig,He=je().addAlertConfig,qe=ka(),We=(qe.title,qe.setTitle),Be=Object(L.a)((function(e){return{root:{color:"white",backgroundColor:sa.a[500],"&:hover":{backgroundColor:sa.a[700]}}}}))(be.a);function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.SNACKBAR_ERROR;_e(e,t),Oe(!1)}function ze(){void 0===ue?He(Ce.DIALOG_PLACE_INSERT_TITLE,Ce.DIALOG_PLACE_INSERT,[{name:"Insert",action:function(){Oe(!0),ge.Places.insertPlace(Xe()).then((function(e){de(e)})).catch((function(e){}))}}]):He(Ce.DIALOG_PLACE_UPDATE_TITLE,Ce.DIALOG_PLACE_UPDATE,[{name:"save and publish",action:function(){var e=Object.assign({},o,{});e.isPublic=1,c(e),Oe(!0),Ge()}},{name:"save",action:function(){Oe(!0),Ge()}}])}function Ge(){Promise.all([void ge.Places.updatePlace(Xe()).then((function(e){})).catch((function(e){})),Ve(ue),Je(ue),$e(ue),Ye(ue),Ze(ue),Ke(ue)]).then((function(e){Ue(!0,Ce.SNACKBAR_CHANGES_SAVED)})).catch((function(e){Ue(!1)}))}function Ye(e){ge.ParkingPlace.updateParkingForPlace(X,"?p="+e).then((function(e){})).catch((function(e){}))}function Ve(e){ge.TagsPlace.updateTagsForPlace(d,"?p="+e).then((function(e){})).catch((function(e){}))}function Ke(e){ge.SourcePlace.updateSourcesForPlace(ae,"?p="+e).then((function(e){})).catch((function(e){}))}function $e(e){ge.CategoriesPlace.updateCategoriesForPlace(h,"?p="+e).then((function(e){})).catch((function(e){}))}function Je(e){ge.PhotoPlace.updatePhotoForPlace(F,"?p="+e).then((function(e){})).catch((function(e){}))}function Ze(e){var t;ge.Schedule.updateScheduleForPlace(ie?(t=O,t.map((function(e){var t=Object(p.a)({},e);return P||(delete t.from,delete t.to),t.periods=t.periods.map((function(e){var t=Object(p.a)({},e);return null!=N&&(t.lastAccommodation=Fe()(t.closeTime,"HH:mm").subtract(N,"minutes").format("HH:mm")),t.closeDay=t.openDay,t})),t.scheduleDefault=!1,console.log(t),t}))):[],"?id="+e).then((function(e){})).catch((function(e){}))}function Xe(){return Object.assign(o,B)}Object(n.useEffect)((function(){void 0!==ue&&ge.Places.getPlaceById("?full=true&p="+ue).then((function(e){!function(e){var t;c({placeId:e.placeId,name:e.name,description:e.description,website:e.website,phoneNumber:e.phoneNumber,hasSchedule:e.hasSchedule,isPublic:e.isPublic,isVerified:e.isVerified,overallStarRating:e.overallStarRating,totalReviews:e.totalReviews,price:e.price,averageTimeSpent:e.averageTimeSpent,bookInAdvance:e.bookInAdvance,grade:e.grade}),U({city:e.city,address:e.address,country:e.country,latitude:e.latitude,longitude:e.longitude,county:e.county,municipality:e.municipality}),K({city:e.city,address:e.address,country:e.country,latitude:e.latitude,longitude:e.longitude,county:e.county,municipality:e.municipality}),j(0===e.schedule.length?Xa:((t=e.schedule).some((function(e){return e.periods.some((function(e){return null!=e.lastAccommodation&&(R(Fe()(e.lastAccommodation,"HH:mm").minutes()-Fe()(e.closeTime,"HH:mm").minutes()),!0)}))})),(t.length>1||t.some((function(e){return null!=e.from&&null!=e.to})))&&T(!0),t.map((function(e){var t=Object(p.a)({},e);return t.periods=t.periods.map((function(e){var t=Object(p.a)({},e);return t.elementId=et.a.generate(),t})),t})))),0===e.schedule.length?oe(!1):oe(!0),ne(e.sources),f(e.tags),E(e.categories),Q(e.parking),H(e.photos),he(!1)}(e),We("Editing place/"+e.name)})).catch((function(e){Ue(!1)}))}),[]),Object(n.useEffect)((function(){void 0===ue&&(We("Add new place"),he(!1)),void 0!==ue&&!1===fe&&Promise.all([Ve(ue),Ye(ue),$e(ue),Je(ue),Ze(ue),Ke(ue)]).then((function(e){Ue(!0,Ce.SNACKBAR_PLACE_INSERTED_SUCCESS)})).catch((function(e){Ue(!1)}))}),[ue]),Object(n.useEffect)((function(){!1===fe&&Ge()}),[o.isPublic]);var Qe=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(mt,{error:we,setError:Pe,checkErrors:De,placeInfo:o,setPlaceInfo:c,selectedSources:ae,setSelectedSources:ne}))}),[o.name,o.description,o.averageTimeSpent,o.phoneNumber,o.price,o.website,o.bookInAdvance,ae]),tt=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(kt,{photos:F,setPhotos:H}))}),[F]),at=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(Kt,{placeInfo:o,locationData:B,setParkingLocation:K,setLocationData:U}))}),[B]),nt=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(ea,{placeInfo:o,allSelectedParkingData:X,setAllSelectedParkingData:Q,locationData:V,setLocationData:K}))}),[X,V]),rt=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(ia,{placeInfo:o,setPlaceInfo:c,selectedTags:d,setSelectedTags:f,selectedCategories:h,setSelectedCategories:E}))}),[h,d,o]),lt=Object(n.useMemo)((function(){return r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(Qa,{scheduleData:O,setScheduleData:j,scheduleOpenIndex:k,setScheduleOpenIndex:I,seasonalScheduleEnabled:P,setSeasonalScheduleEnabled:T,setLastAccommodation:R,isScheduleEnabled:ie,setIsScheduleEnabled:oe,lastAccommodation:N}))}),[O,k,N,P,ie]);return r.a.createElement("div",{className:t.root},fe?r.a.createElement("div",{className:t.loader},r.a.createElement(oa.a,null)):r.a.createElement("div",{className:t.content},Qe,void 0!==ue?r.a.createElement(G.a,{elevation:4,className:t.paperContent},r.a.createElement(ja,{placeInfo:o})):null,tt,at,nt,rt,lt),ye?r.a.createElement(Z.a,null):null,r.a.createElement(G.a,{elevation:1,className:t.bottom},!1===o.isVerified&&void 0!==ue?r.a.createElement(Be,{variant:"contained",color:"primary",onClick:function(){He(Ce.DIALOG_PLACE_VERIFY_TITLE,Ce.DIALOG_PLACE_VERIFY_MESSAGE,[{name:"agree",action:function(){var e=Object.assign({},o,{});e.isPublic=1,e.isVerified=1,c(e)}}])},className:t.button},"Verify place"):r.a.createElement(xe.a,{control:r.a.createElement(Lt.a,{checked:o.isPublic,onChange:function(){He(Ce.DIALOG_PLACE_PUBLISH_TITLE,o.isPublic?Ce.DIALOG_PLACE_UNPUBLISH_MESSAGE:Ce.DIALOG_PLACE_PUBLISH_MESSAGE,[{name:"Agree",action:function(){var e=Object.assign({},o,{});e.isPublic=!e.isPublic,c(e)}}])},name:"isPublic"}),label:"Make this place public"}),r.a.createElement(be.a,{variant:"contained",color:"primary",onClick:function(){return ze()},className:t.button},"Save"),null!=ue?r.a.createElement(be.a,{variant:"contained",color:"primary",onClick:function(){Me(!0)},className:t.button},"Add to recommendation"):null,r.a.createElement(Aa,{open:Le,setOpen:Me,objectId:o.placeId,type:Fa})))})),tn=a(95),an=a(406),nn=a.n(an),rn=a(805),ln=a(155),on=a.n(ln),cn=a(217),sn=a.n(cn),un=a(396),dn=a.n(un),mn=a(395),pn=a.n(mn),fn=a(397),gn=a.n(fn),bn=a(398),hn=a.n(bn),En=a(399),vn=a.n(En),yn=a(400),On=a.n(yn),jn=a(402),Cn=a.n(jn),Sn=a(401),kn=a.n(Sn),In=a(375),xn=[{icon:r.a.createElement(pn.a,null),label:"Metro"},{icon:r.a.createElement(dn.a,null),label:"Bike"},{icon:r.a.createElement(gn.a,null),label:"Bus"},{icon:r.a.createElement(hn.a,null),label:"Car"},{icon:r.a.createElement(vn.a,null),label:"Train"},{icon:r.a.createElement(On.a,null),label:"Plane"},{icon:r.a.createElement(kn.a,null),label:"Walk"},{icon:r.a.createElement(Cn.a,null),label:"Tram"}];var wn=Me()((function(e){return{root:{display:"flex",flexFlow:"column wrap"},transportSelectWrapper:{display:"flex",alignItems:"center"},transportSelect:{marginLeft:e.spacing(1),width:"100px"}}}))((function(e){var t=e.classes,a=e.transportId,l=e.transportChangeCallback,i=Object(n.useState)(null==a?0:a),o=Object(m.a)(i,2),c=o[0],s=o[1];return r.a.createElement("div",{className:t.root},r.a.createElement(sn.a,null),r.a.createElement("div",{className:t.transportSelectWrapper},xn[c].icon,r.a.createElement(rt.a,{className:t.transportSelect},r.a.createElement(In.a,{value:c,onChange:function(e){s(e.target.value),l({transport:parseInt(e.target.value)})}},xn.map((function(e,t){return r.a.createElement("option",{key:t,value:t}," ",e.label)}))))),r.a.createElement(sn.a,null))}));var Pn=Object(L.a)((function(e){var t;return{cardRoot:Object(d.a)({},e.breakpoints.only("lg"),{display:"flex"}),details:{display:"flex",flexDirection:"column",flex:5},content:{flex:"1 0 auto"},cover:(t={},Object(d.a)(t,e.breakpoints.down("lg"),{height:"200px"}),Object(d.a)(t,e.breakpoints.only("lg"),{flex:1,height:"auto"}),t),root:{display:"flex",flexFlow:"column wrap"},addParkingWrapper:{display:"inline-block"}}}))((function(e){var t,a=e.classes,n=e.elementData,l=e.removeCallback,i=e.tourInfoReducer,o=e.currentDay,c=e.elementIndex,s=e.lastElement,u=e.handleEditPlace;return r.a.createElement("div",{className:a.root},r.a.createElement(bt.a,{className:a.cardRoot,onClick:function(){return u(n.data.details.placeId)}},null!=n.data.details.photos&&n.data.details.photos.length>0&&r.a.createElement(gt.a,{className:a.cover,image:n.data.details.photos[0].url}),r.a.createElement("div",{className:a.details},r.a.createElement(da.a,{className:a.content},r.a.createElement(j.a,{component:"h5",variant:"h5"},n.data.details.name),r.a.createElement(j.a,{variant:"subtitle1",color:"textSecondary"},null==(t=n.data.details.description)?"":t.length>500?t.substring(0,500)+"...":t))),r.a.createElement(Da.a,{onClick:function(e){e.stopPropagation(),e.preventDefault()},action:r.a.createElement(S.a,{"aria-label":"remove",onClick:function(){return l(n)}},r.a.createElement(on.a,null))})),r.a.createElement(J.a,{className:a.descriptionInput,multiline:!0,value:n.data.note,label:"Add a note",style:{marginTop:10,marginBottom:5},variant:"outlined",onChange:function(e){i({type:"UPDATE_ELEMENT",day:o,index:c,data:Object(p.a)(Object(p.a)({},n),{},{note:e.target.value})})}}),null!=n.data.transport&&!s&&r.a.createElement(wn,{transportChangeCallback:function(e){var t=e.transport;i({type:"UPDATE_ELEMENT",day:o,index:c,data:Object(p.a)(Object(p.a)({},n),{},{transport:{fk_transportId:t}})})},transportId:n.data.transport.fk_transportId}))})),Tn=Object(pt.b)((function(e){var t=e.handleEditPlace,a=e.currentDay,n=e.elementData,l=e.removePlaceCallback,i=e.classes,o=e.tourInfoReducer,c=e.elementIndex,s=e.lastElement;return r.a.createElement("div",null,r.a.createElement(Pn,{removeCallback:l,classes:{root:i.tourPlaceComponent},elementData:n,tourInfoReducer:o,elementIndex:c,currentDay:a,handleEditPlace:t,lastElement:s}))})),An=Object(pt.a)((function(e){var t=e.handleEditPlace,a=e.currentDay,n=e.removeElementCallback,l=e.tourInfo,i=e.classes,o=e.tourInfoReducer;return r.a.createElement("ul",null,l.days[a].tour.map((function(e,c){switch(e.type){case Qn.place:return r.a.createElement(Tn,{key:e.data.details.placeId,elementIndex:c,elementData:e,lastElement:c===l.days[a].tour.length-1,index:c,classes:i,currentDay:a,handleEditPlace:t,tourInfoReducer:o,removePlaceCallback:function(){return n(c)}})}})))}));var Dn=Object(L.a)((function(e){return{tourPlaceComponent:{margin:e.spacing(2)},root:{display:"flex",flexFlow:"column wrap",margin:e.spacing(1)}}}))((function(e){var t=e.classes,a=e.tourInfo,n=e.tourInfoReducer,l=e.currentDay,i=(e.errorInfo,e.setErrorInfo,e.handleEditPlace);return r.a.createElement("div",{className:t.root},0===a.days[l].tour.length&&r.a.createElement(Mt.a,{severity:"warning"},"You have not added any places for the currently selected day."),r.a.createElement(An,{pressDelay:200,disableAutoscroll:!1,tourInfoReducer:n,tourInfo:a,onSortEnd:function(e){var t=e.oldIndex,a=e.newIndex;n({type:"MOVE_ELEMENT",day:l,oldIndex:t,newIndex:a})},handleEditPlace:i,currentDay:l,classes:t,removeElementCallback:function(e){n({type:"REMOVE_ELEMENT",day:l,index:e})}}))})),Nn=a(423),Rn=a(403),Ln=a.n(Rn),Mn=a(87),_n=Object(g.a)((function(e){return{root:{padding:"2px 4px",display:"flex",alignItems:"center",margin:e.spacing(2)},iconButton:{padding:10},input:{marginLeft:e.spacing(1),flex:1},divider:{margin:4}}}));function Fn(e){var t=e.hint,a=e.searchCallback,n=_n(),l=Object(Mn.a)((function(e){return function(e){a(e.target.value)}(e)}),500);return r.a.createElement(G.a,{component:"form",className:n.root},r.a.createElement(Nn.a,{className:n.input,placeholder:t,inputProps:{"aria-label":t},onChange:function(e){e.persist(),l(e)}}),r.a.createElement(S.a,{className:n.iconButton,"aria-label":"search"},r.a.createElement(Ln.a,null)),r.a.createElement(C.a,{className:n.divider,orientation:"vertical"}))}var Hn=a(404),qn=a.n(Hn),Wn=a(405),Bn=a.n(Wn);var Un=Object(L.a)((function(e){return{searchInputComponent:{},placeCard:{margin:e.spacing(1,8,1,8)}}}))((function(e){var t=e.classes,a=e.addPlaceCallback,l=(e.apiPlacesFound,e.setApiPlacesFound),i=e.localPlacesFound,o=e.setLocalPlacesFound,c=Object(n.useState)(!1),s=Object(m.a)(c,2),u=s[0],d=s[1],p=0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Fn,{hint:"Search for a place",searchCallback:function(e){e.length<3||(o([]),l([]),d(!0),ge.Places.getAllPlacesAdmin("?keyword="+e).then((function(e){o(e.list),d(!1)})).catch((function(e){console.log(e)})))},className:t.searchInputComponent}),u?r.a.createElement(oa.a,null):r.a.createElement(r.a.Fragment,null,function(){var e=[];return i.forEach((function(n){var l,i;e.push(r.a.createElement(_a,(l=n,i=p,{classes:{root:t.placeCard},key:l.placeId,renderActionArea:function(){return r.a.createElement("div",null,r.a.createElement(be.a,{color:"primary",onClick:function(){return a(l,i)}},r.a.createElement(Ee.a,null)),r.a.createElement(Ea.a,{title:i===p?"This place is from our database":"This place is from API","aria-label":"add"},i===p?r.a.createElement(qn.a,null):r.a.createElement(Bn.a,null)))},placeData:l})))})),e}()))}));var zn=Object(L.a)((function(e){return{root:{display:"flex",margin:e.spacing(1)},radioButtonArea:{},cardArea:{flex:1,display:"flex"},content:{flex:"1 1 auto"},descriptionInput:{marginTop:e.spacing(2),width:"100%",height:"auto"},headerWrap:{}}}))((function(e){var t=e.classes,a=e.onSelectCallback,n=e.index,l=e.currentDay,i=e.tourInfoReducer,o=e.description,c=e.handleRemoveDay;return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.radioButtonArea},r.a.createElement(Oa.a,{checked:n===l,onChange:function(e){a(n)}})),r.a.createElement(bt.a,{className:t.cardArea},r.a.createElement(da.a,{className:t.content},r.a.createElement(j.a,{component:"h5",variant:"h5"},"Day ",n+1),r.a.createElement(J.a,{className:t.descriptionInput,multiline:!0,label:"Description",value:null==o?"":o,variant:"outlined",onChange:function(e){!function(e){i({type:"UPDATE_DAY",day:n,data:{description:e}})}(e.target.value)}})),r.a.createElement(Da.a,{action:r.a.createElement(S.a,{"aria-label":"remove",onClick:function(){return c(n)}},r.a.createElement(on.a,null))})))})),Gn=Object(pt.b)((function(e){var t=e.dayInfo,a=e.day,n=e.currentDay,l=e.onSelectCallback,i=e.tourInfoReducer,o=e.removeDayCallback;return r.a.createElement(zn,{description:t.description,currentDay:n,index:a,handleRemoveDay:o,onSelectCallback:l,tourInfoReducer:i})})),Yn=Object(pt.a)((function(e){var t=e.elements,a=e.currentDay,n=e.onSelectCallback,l=e.tourInfoReducer,i=e.removeDayCallback;return r.a.createElement("ul",{style:{padding:"0px"}},t.map((function(e,t){return r.a.createElement(Gn,{currentDay:a,day:t,index:t,removeDayCallback:i,key:e.elementIdentifier,dayInfo:e,onSelectCallback:n,tourInfoReducer:l})})))}));var Vn=Object(L.a)((function(e){return{root:{margin:e.spacing(1)},addDayButton:{marginTop:e.spacing(1)},footerWrapper:{display:"flex",width:"100%",justifyContent:"flex-end"}}}))((function(e){var t=e.classes,a=e.currentDay,n=e.setCurrentDay,l=e.tourInfo,i=e.tourInfoReducer,o=je().addAlertConfig,c=function(e){i({type:"REMOVE_DAY",day:e}),e===a&&n(e-1)};return r.a.createElement("div",{className:t.root},r.a.createElement(Yn,{pressDelay:200,disableAutoscroll:!1,elements:l.days,currentDay:a,onSortEnd:function(e){var t=e.oldIndex,a=e.newIndex;i({type:"MOVE_DAY",oldIndex:t,newIndex:a}),n(a)},removeDayCallback:function(e){1===l.days.length?o("Warning","The tour has to have at least one day",[]):l.days[e].tour.length>0?o("Warning","Are you sure you want to remove this day?",[{name:"yes",action:function(){c(e)}}],(function(){})):c(e)},onSelectCallback:function(e){n(e)},tourInfoReducer:i}),r.a.createElement("div",{className:t.footerWrapper},r.a.createElement(be.a,{variant:"text",color:"secondary",size:"large",className:t.addDayButton,onClick:function(){i({type:"ADD_DAY",data:{description:"",elementIdentifier:et.a.generate(),tour:[]}})},startIcon:r.a.createElement(Ee.a,null)},"Add another day")))}));function Kn(e,t){var a=[];switch(t.type){case"ADD_ELEMENT":return null!==e.days&&t.data.type===Qn.place&&e.days.some((function(e){return null!==e.tour&&e.tour.some((function(e){return e.type===Qn.place&&e.data.details.placeId===t.data.data.details.placeId}))}))?(null!==t.onError&&void 0!==t.onError&&t.onError(),e):(e.days.forEach((function(e,n){n===t.day?a.push(Object(p.a)(Object(p.a)({},e),{},{tour:[].concat(Object(Ae.a)(e.tour),[t.data])})):a.push(e)})),Object(p.a)(Object(p.a)({},e),{},{days:Object(Ae.a)(a)}));case"UPDATE_ELEMENT":return e.days.forEach((function(e,n){if(n===t.day){var r=e.tour;r[t.index]=Object(p.a)(Object(p.a)({},r[t.index]),{},{data:Object(p.a)(Object(p.a)({},r[t.index].data),t.data)}),a.push(Object(p.a)(Object(p.a)({},e),{},{tour:r}))}else a.push(e)})),Object(p.a)(Object(p.a)({},e),{},{days:Object(Ae.a)(a)});case"ADD_DAY":return Object(p.a)(Object(p.a)({},e),{},{days:[].concat(Object(Ae.a)(e.days),[t.data])});case"MOVE_DAY":return Object(p.a)(Object(p.a)({},e),{},{days:Object(pt.c)(e.days,t.oldIndex,t.newIndex)});case"MOVE_ELEMENT":return a=e.days.map((function(e,a){return a===t.day?Object(p.a)(Object(p.a)({},e),{},{tour:Object(pt.c)(e.tour,t.oldIndex,t.newIndex)}):e})),Object(p.a)(Object(p.a)({},e),{},{days:Object(Ae.a)(a)});case"UPDATE_DAY":return a=e.days.map((function(e,a){return a===t.day?Object(p.a)(Object(p.a)({},e),t.data):e})),Object(p.a)(Object(p.a)({},e),{},{days:Object(Ae.a)(a)});case"REMOVE_ELEMENT":return a=e.days.map((function(e,a){return a===t.day?Object(p.a)(Object(p.a)({},e),{},{tour:e.tour.filter((function(e,a){return a!==t.index}))}):e})),Object(p.a)(Object(p.a)({},e),{},{days:Object(Ae.a)(a)});case"REMOVE_DAY":return a=e.days.filter((function(e,a){return a!==t.day})),Object(p.a)(Object(p.a)({},e),{},{days:a});case"UPDATE_TOUR":return Object(p.a)(Object(p.a)({},e),t.data);case"SET_ALL":return t.data;default:return e}}var $n=Me()((function(e){return{root:{margin:e.spacing(4)},nameField:{width:"100%"},descriptionField:{marginTop:e.spacing(2),width:"100%",height:"auto"},publicityDiv:{width:"100%"},button:{margin:e.spacing(2),color:"#ffffff"}}}))((function(e){var t=e.classes,a=e.tourInfo,l=e.tourInfoReducer,i=e.errorInfo,o=e.setErrorInfo,c=e.availableCategories,s=e.selectedCategories,u=e.setSelectedCategories,d=e.setAvailableCategories,m=e.tourId;Object(n.useEffect)((function(){""===a.name?o((function(e){return Object(p.a)(Object(p.a)({},e),{},{errors:Object(p.a)(Object(p.a)({},e.errors),{},{titleMissing:!0})})})):o((function(e){return Object(p.a)(Object(p.a)({},e),{},{errors:Object(p.a)(Object(p.a)({},e.errors),{},{titleMissing:!1})})}))}),[a.name]);var f=i.showErrors&&i.errors.titleMissing,g=Me()((function(e){return{root:{color:"white",backgroundColor:sa.a[500],"&:hover":{backgroundColor:sa.a[700]}}}}))(be.a);return r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{label:"Tour name",variant:"outlined",error:f,helperText:f?"Please provide a title for your tour":"",value:a.name,onChange:function(e){l({type:"UPDATE_TOUR",data:{name:e.target.value}})},className:t.nameField}),r.a.createElement(J.a,{className:t.descriptionField,multiline:!0,label:"Description",value:a.description,variant:"outlined",onChange:function(e){l({type:"UPDATE_TOUR",data:{description:e.target.value}})}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(j.a,{component:"h6",variant:"h6"},"Categories for this tour"),r.a.createElement(Re,{options:c,id:"categoryId",label:"Select category",setOptions:d,setSelectedOptions:u,selectedOptions:s}),void 0!==m&&r.a.createElement("div",{className:t.publicityDiv},a.isVerified?r.a.createElement("div",null,r.a.createElement(xe.a,{control:r.a.createElement(Lt.a,{checked:a.isPublished,onChange:function(){l({type:"UPDATE_TOUR",data:{isPublished:!a.isPublished}})},name:"isPublic"}),label:"Make this tour public?"})):r.a.createElement(g,{variant:"contained",color:"primary",onClick:function(){l({type:"UPDATE_TOUR",data:{isVerified:!0}})},className:t.button},"Verify tour")))})),Jn=window.google,Zn=Object(It.withGoogleMap)((function(e){return r.a.createElement(It.GoogleMap,{ref:e.refMap,defaultZoom:8,defaultCenter:{lat:55.2983804,lng:23.9132164}},e.children)}));var Xn=Me()((function(e){var t;return{root:{margin:e.spacing(4)},cover:(t={},Object(d.a)(t,e.breakpoints.down("lg"),{height:"200px"}),Object(d.a)(t,e.breakpoints.only("lg"),{flex:1,height:"auto"}),t),largeIcon:{width:e.spacing(14),height:e.spacing(14)}}}))((function(e){var t=e.classes,l=e.tourInfo,i=e.currentDay,o=e.addPlace,c=e.removePlace,s=Object(n.useState)(),u=Object(m.a)(s,2),d=u[0],p=u[1];console.log("rerender");var f=Object(n.useState)([]),g=Object(m.a)(f,2),b=g[0],h=g[1],E=Object(n.useState)([]),v=Object(m.a)(E,2),y=v[0],O=v[1],C=Object(n.useState)([]),S=Object(m.a)(C,2),k=S[0],I=S[1],x=Object(n.useState)([]),w=Object(m.a)(x,2),P=w[0],T=w[1],A=Object(n.useState)(!1),D=Object(m.a)(A,2),N=D[0],R=D[1],L=Object(n.useRef)(null),M=Object(n.useContext)(Ye).filterQuery;function _(){var e;console.log("Getting all places...",L.current.getCenter().lat()),e=M+"&p=0&s=100&l="+L.current.getCenter().lat()+","+L.current.getCenter().lng()+"range=50",R(!0),ge.Places.getAllPlacesAdmin(e).then((function(e){T(Array(e.list.length).fill(!1)),I(e.list),R(!1)})).catch((function(e){console.log(e),R(!1)}))}function F(){return k.map((function(e,t){var a=parseFloat(e.latitude),n=parseFloat(e.longitude);return r.a.createElement(It.Marker,{zIndex:1,key:e.placeId,position:{lat:a,lng:n},onClick:function(){var e=Object.assign({},P);e[t]=!0,T(e)}},P[t]&&r.a.createElement(It.InfoWindow,{onCloseClick:function(){var e=Object.assign({},P);e[t]=!1,T(e)}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(j.a,{variant:"h6"},e.name),r.a.createElement(be.a,{onClick:function(){var t;t=e,T(Array(k.length).fill(!1)),o(t,Qn.place)},variant:"text",color:"secondary",size:"large",startIcon:r.a.createElement(Ee.a,null)},"Add this place to tour!"))))}))}Object(n.useEffect)((function(){var e=function(){var e=l.days[i].tour.filter((function(e){return e.type===Qn.place})),t=[];return e.forEach((function(e){var a=e.data.details.placeId,n=e.data.details.latitude,r=e.data.details.longitude,l=e.data.details.name,i=e.data.details.photos;t.push({placeId:a,latitude:n,longitude:r,name:l,photo:i.length>0?i[0].url:null})})),h(Array(t.length).fill(!1)),O(t),t}();if(e.length>1){var t=e.map((function(e){return{location:{lat:e.latitude,lng:e.longitude},stopover:!0}})),a=t.shift().location,n=null;n=t.length>0?t.pop().location:a,(new Jn.maps.DirectionsService).route({origin:a,destination:n,travelMode:Jn.maps.TravelMode.DRIVING,waypoints:t},(function(e,t){t===Jn.maps.DirectionsStatus.OK?p(e):alert(t)}))}else p(null)}),[i,l.days]),Object(n.useEffect)((function(){N||null!=L.current&&_()}),[M]);var H=Object(n.useMemo)((function(){return r.a.createElement(Wt,{position:window.google.maps.ControlPosition.TOP_CENTER},r.a.createElement("div",null,N?r.a.createElement(oa.a,null):r.a.createElement(be.a,{variant:"contained",color:"primary",onClick:function(){_()}},"Search area...")))}),[N]);return r.a.createElement("div",{className:t.root},r.a.createElement(Je,null),r.a.createElement(Zn,{loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"400px"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),refMap:L},H,r.a.createElement(F,null),d?r.a.createElement(It.DirectionsRenderer,{options:{suppressMarkers:!0,draggable:!1},draggable:!1,directions:d}):null,y.map((function(e,n){var o={lat:e.latitude,lng:e.longitude};return r.a.createElement(It.Marker,{zIndex:2,icon:{url:a(365),scaledSize:new window.google.maps.Size(48,48),origin:new window.google.maps.Point(0,0),labelOrigin:new window.google.maps.Point(24,16)},key:n,position:o,label:{text:"".concat(n+1),color:"white"},onClick:function(){var e=Object.assign({},b);e[n]=!0,h(e)}},b[n]&&r.a.createElement(It.InfoWindow,{onCloseClick:function(){var e=Object.assign({},b);e[n]=!1,h(e)}},r.a.createElement(bt.a,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},e.photo?r.a.createElement(zt.a,{alt:"Remy Sharp",src:e.photo,className:t.largeIcon}):null,r.a.createElement(j.a,null,e.name),r.a.createElement(be.a,{onClick:function(){return t=e,void l.days[i].tour.map((function(e,a){e.type===Qn.place&&e.data.details.placeId===t.placeId&&c(a)}));var t},style:{marginTop:12},variant:"contained",color:"secondary",startIcon:r.a.createElement(V.a,null)},"Remove from tour"))))}))))})),Qn={place:0,transport:1},er={name:"",description:"",isVerified:!0,isPublished:!1,days:[{description:"",elementIdentifier:"jkasfbjkdsbjk",tour:[]}]};var tr=Object(L.a)((function(e){var t,a;return{root:(t={},Object(d.a)(t,e.breakpoints.down("lg"),{overflow:"scroll"}),Object(d.a)(t,e.breakpoints.up("lg"),{overflow:"initial",display:"flex"}),Object(d.a)(t,"height","calc(100% - 64px)"),Object(d.a)(t,"width","100%"),Object(d.a)(t,"&::-webkit-scrollbar",{display:"none"}),t),loader:{display:"flex",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh"},rightLayout:Object(d.a)({flex:2,"&::-webkit-scrollbar":{display:"none"}},e.breakpoints.up("lg"),{height:"100%",overflowY:"scroll"}),leftLayout:(a={},Object(d.a)(a,e.breakpoints.up("lg"),{height:"100%"}),Object(d.a)(a,"overflowY","scroll"),Object(d.a)(a,"flex",1),Object(d.a)(a,"&::-webkit-scrollbar",{display:"none"}),a),actionsArea:{padding:e.spacing(1),display:"flex",justifyContent:"flex-end"}}}))((function(e){var t=e.classes,a=e.match,l=Object(n.useState)([]),i=Object(m.a)(l,2),o=i[0],c=i[1],s=Object(n.useState)([]),u=Object(m.a)(s,2),d=u[0],f=u[1],g=Object(n.useState)(0),b=Object(m.a)(g,2),h=b[0],E=b[1],v=Object(n.useState)(a.params.tourId),y=Object(m.a)(v,2),O=y[0],j=y[1],S=Object(n.useState)(void 0!==a.params.tourId),k=Object(m.a)(S,2),I=k[0],x=k[1],w=Object(n.useState)(!1),P=Object(m.a)(w,2),T=P[0],A=P[1],D=Object(n.useState)([]),N=Object(m.a)(D,2),R=N[0],L=N[1],M=Object(n.useState)([]),_=Object(m.a)(M,2),F=_[0],H=_[1],q=Object(n.useState)({errors:{titleMissing:!1},showErrors:!1}),W=Object(m.a)(q,2),B=W[0],U=W[1],z=r.a.useReducer(Kn,er),Y=Object(m.a)(z,2),V=Y[0],K=Y[1],$=Ie().addConfig,J=function(e,t){K({type:"ADD_ELEMENT",day:h,data:{type:Qn.place,data:{type:t,details:Object(p.a)({},e),transport:{fk_transportId:3},note:""}},onError:function(){$(!1,"This place already exists in this tour.")}})},Z=function(e){K({type:"REMOVE_ELEMENT",day:h,index:e})},X=function(e){window.open("https://www.traveldirection.ax.lt/app/addplace/".concat(e))};Object(n.useEffect)((function(){void 0!==O?Q():ge.Categories.getAllCategories().then((function(e){H(e)})).catch((function(){$(!1,"Categories failed to load")}))}),[]);var Q=function(){Promise.all([ge.Tour.getTour("?id="+O),ge.Categories.getAllCategories(),ge.Tour.getTourCategories("?id="+O)]).catch((function(){$(!1,"Tour has failed to load"),j(void 0)})).then((function(e){!function(e){var t=[];e.days.forEach((function(e){var a=[];e.data.forEach((function(e){var t={type:Qn.place,data:{details:e.place,type:e.place.type,transport:null==e.transport?{fk_transportId:3}:{fk_transportId:e.transport.fk_transportId-1},note:null==e.note?"":e.note}};delete t.data.details.type,a.push(t)}));var n=Object(p.a)(Object(p.a)({},e),{},{tour:a,elementIdentifier:et.a.generate()});delete n.data,t.push(n)}));var a=Object(p.a)(Object(p.a)({},e),{},{days:t});K({type:"SET_ALL",data:a})}(e[0]),H(e[1]),L(e[2])})).finally((function(){x(!1)}))},ee=function(){var e=!1;if(Object.keys(B.errors).map((function(t,a){B.errors[t]&&(U((function(e){return Object(p.a)(Object(p.a)({},e),{},{showErrors:!0})})),e=!0)})),!e){U((function(e){return Object(p.a)(Object(p.a)({},e),{},{showErrors:!1})}));var t=[];V.days.forEach((function(e){var a=Object(p.a)(Object(p.a)({},e),{},{data:[]});delete a.tour,delete a.elementIdentifier;for(var n=0;n<e.tour.length;n++){var r=e.tour[n];if(r.type===Qn.place){var l={place:{type:r.data.type,placeId:r.data.details.placeId},note:r.data.note};n!==e.tour.length-1?l.transport={fk_transportId:r.data.transport.fk_transportId+1}:l.transport={fk_transportId:null},a.data.push(l)}}t.push(a)}));var a=Object(p.a)(Object(p.a)({},V),{},{days:t});void 0===O?ge.Tour.insertTour(a).then((function(e){return j(e),e})).then((function(e){return Promise.all([ge.Tour.updateTourCategories(R,"?p="+e)])})).then((function(){$(!0,"Tour has been inserted successfully!")})).catch((function(e){$(!1,"Something went wrong while saving this tour.")})):Promise.all([ge.Tour.updateTour(a,"?id="+O),ge.Tour.updateTourCategories(R,"?p="+O)]).then((function(){$(!0,"Tour has been updated successfully!")})).catch((function(e){$(!1,"Something went wrong while saving this tour.")}))}},te=Object(n.useMemo)((function(){return r.a.createElement("div",{className:t.leftLayout},r.a.createElement(Un,{addPlaceCallback:J,localPlacesFound:o,setLocalPlacesFound:c,apiPlacesFound:d,setApiPlacesFound:f}))}),[o,d,h]),ae=JSON.stringify(V.days.map((function(e){var t=Object(p.a)({},e);return delete t.description,t.tour.map((function(e){return e.data.details}))}))),ne=Object(n.useMemo)((function(){return r.a.createElement(Dn,{errorInfo:B,setErrorInfo:U,handleEditPlace:X,currentDay:h,tourInfoReducer:K,tourInfo:V})}),[B,h,JSON.stringify(V.days.map((function(e){return e.tour})))]),re=Object(n.useMemo)((function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Xn,{tourInfo:V,currentDay:h,addPlace:J,removePlace:Z}))}),[ae,h]),le=Object(n.useMemo)((function(){return r.a.createElement(Vn,{currentDay:h,setCurrentDay:E,tourInfo:V,tourInfoReducer:K})}),[JSON.stringify(V.days.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{tour:null})})))]),ie=Object(n.useMemo)((function(){return r.a.createElement("div",null,le,r.a.createElement(C.a,{variant:"middle"}),re,ne)}),[V.days,h,B]),oe=Object(n.useMemo)((function(){return r.a.createElement($n,{tourInfo:V,tourInfoReducer:K,errorInfo:B,setErrorInfo:U,tourId:O,setSelectedCategories:L,selectedCategories:R,availableCategories:F,setAvailableCategories:H})}),[F,R,O,B,V.name,V.description,V.isPublished,V.isVerified]),ce=Object(n.useMemo)((function(){return r.a.createElement(G.a,{className:t.rightLayout},oe,r.a.createElement(C.a,{variant:"middle"}),ie,r.a.createElement("div",{className:t.actionsArea},r.a.createElement(be.a,{variant:"contained",color:"primary",onClick:function(){return A(!0)},disabled:null==O},"Add tour to recommendation"),r.a.createElement(be.a,{variant:"contained",color:"primary",onClick:ee},"Save this tour")))}),[V,h,B,F,R]),se=nn()(),ue=Object(rn.a)(se.breakpoints.up("lg")),de=r.a.createElement(r.a.Fragment,null,ue?r.a.createElement(r.a.Fragment,null,te,ce):r.a.createElement(r.a.Fragment,null,ce,te));return r.a.createElement("div",{className:t.root},r.a.createElement(Aa,{setOpen:A,open:T,objectId:O,type:Ha}),I?r.a.createElement("div",{className:t.loader},r.a.createElement(oa.a,null)):de)})),ar=[{id:"name",numeric:!1,disablePadding:!1,label:"Tour name",isId:!0},{id:"description",numeric:!1,disablePadding:!1,label:"Tour description",isId:!1},{id:"lastModified",numeric:!1,disablePadding:!1,label:"Date modified",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}];var nr=Object(L.a)((function(e){var t;return{button:{margin:e.spacing(2)},input:{display:"none"},sortingButtons:{padding:e.spacing(2),display:"flex",flexDirection:"column"},root:{height:"100vh",width:"100%",overflow:"auto"},buttonsDiv:{backgroundColor:"red",justifyContent:"flex-end"},content:(t={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Object(d.a)(t,e.breakpoints.down("lg"),{padding:e.spacing(1)}),Object(d.a)(t,e.breakpoints.up("lg"),{padding:e.spacing(8)}),t)}}))((function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),l=a[0],i=a[1],o=Object(n.useState)([]),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)(!0),p=Object(m.a)(d,2),f=p[0],g=p[1],b=e.classes,h=Object(n.useState)([{filterLabel:"Unverified",filter:!1,filterName:"unverified"},{filterLabel:"Unpublished",filter:!1,filterName:"unpublished"}]),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)(""),j=Object(m.a)(O,2),C=j[0],k=j[1],I=je().addAlertConfig,x=Ie().addConfig;function w(e){console.log("deita",e.list),g(!1);var t=[];e.list.map((function(e){t.push(e)})),delete e.list,i(t),u(e)}Object(n.useEffect)((function(){f||M("?o="+C)}),[C]);var P=r.a.useState(null),T=Object(m.a)(P,2),A=T[0],D=T[1],N=Boolean(A),R=N?"simple-popover":void 0,L=function(e){D(e.currentTarget)};return r.a.createElement("div",{className:b.root},r.a.createElement("div",{className:b.content},r.a.createElement(ae,{title:"Tours",headCells:ar,data:l,pagingInfo:s,checkable:!1,changePageCallback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";g(!0),M("?p="+e+"&s=10&keyword="+t+"&o="+C)},updateCallback:function(e){se.push("/app/addtour/"+e)},removeCallback:function(e){console.log("tour id",e),I(Ce.DIALOG_TOUR_DELETE_TITLE,Ce.DIALOG_TOUR_DELETE_MESSAGE,[{name:"Delete",action:function(){g(!0),ge.Tour.removeTour("?id="+e).then((function(t){var a=[];l.map((function(t){t.tourId!==e&&a.push(t)})),i(a),x(!0,Ce.SNACKBAR_TOUR_REMOVE_SUCCESS),g(!1)})).catch((function(e){g(!1),x(!1,Ce.SNACKBAR_ERROR)}))}}],(function(){g(!1)}))},id:"tourId",isLoading:f,customToolbarElements:r.a.createElement("div",null,r.a.createElement(Ea.a,{"aria-describedby":R,title:"Filter list"},r.a.createElement(S.a,{"aria-label":"filter list",onClick:L},r.a.createElement(ha.a,null))),r.a.createElement(va.a,{id:R,open:N,anchorEl:A,onClose:function(){D(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement("div",{className:b.sortingButtons},v.map((function(e){return r.a.createElement(xe.a,{control:r.a.createElement(we.a,{checked:e.filter,onChange:function(){return function(e){var t=[],a=[];v.map((function(n){n.filterName===e&&(n.filter=!n.filter),n.filter&&a.push(n.filterName),t.push(n)})),k(a.join(",")),y(t)}(e.filterName)},name:e.filterName}),label:e.filterLabel})})))))}),r.a.createElement(ve.a,{display:"flex",justifyContent:"flex-end"},r.a.createElement(be.a,{onClick:function(){se.push("/app/addtour")},variant:"text",color:"secondary",size:"large",className:b.button,startIcon:r.a.createElement(Ee.a,null)},"Add"))));function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ge.Tour.getAllToursAdmin(e).then((function(e){console.log(e),w(e)})).catch((function(e){console.log(e)}))}})),rr=[{id:"name",numeric:!1,disablePadding:!1,label:"Category name",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}],lr=[{id:"name",numeric:!1,disablePadding:!1,label:"Category name",isId:!1},{id:"label",numeric:!1,disablePadding:!1,label:"Mapped categories",isId:!1},{id:"count",numeric:!1,disablePadding:!1,label:"Count",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}],ir=[{id:"name",numeric:!1,disablePadding:!1,label:"Tag name",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}];var or=Object(L.a)((function(e){var t;return{root:{height:"100vh",width:"100%",overflow:"auto"},content:(t={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Object(d.a)(t,e.breakpoints.down("lg"),{padding:e.spacing(1)}),Object(d.a)(t,e.breakpoints.up("lg"),{padding:e.spacing(8)}),t),buttonWrapper:{display:"flex",justifyContent:"flex-end",width:"100%"}}}))((function(e){var t=e.classes,a=je().addAlertConfig,l=Ie().addConfig,i=ra().addEditDialogConfig,o=Object(n.useState)({categories:!1,tags:!1}),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)([]),f=Object(m.a)(d,2),g=f[0],b=f[1],h=Object(n.useState)([]),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)([]),j=Object(m.a)(O,2),C=j[0],S=j[1],k=Object(n.useState)([]),I=Object(m.a)(k,2),x=I[0],w=I[1];Object(n.useEffect)((function(){u({categories:!0,tags:!0,abstractedCats:!0}),Promise.all([ge.Categories.getAllCategories(),ge.Tags.getAllTags(),ge.Categories.getAllAbstractedCategories()]).then((function(e){b(e[0]),function(e){console.log("Tags",e),S(e);var t=e.filter((function(e){return!0===e.isFeatured}));console.log("Featured tags",t),w(t)}(e[1]),function(e){for(var t=e,a=0;a<t.length;a++)t[a].count=t[a].mappedCategories.length,t[a].label=t[a].mappedCategories.map((function(e){return e.name})).join(" | ");y(t)}(e[2])})).catch((function(){l(!1,"Could not retrieve data!")})).finally((function(){u((function(e){return Object(p.a)(Object(p.a)({},e),{},{categories:!1,tags:!1,abstractedCats:!1})}))}))}),[]);var P=function(e,t){return null==e||e.length<1||t.name.includes(e)};return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.content},r.a.createElement(ae,{title:"Categories",headCells:rr,data:g,pagingInfo:null,checkable:!1,searchFunction:P,changePageCallback:function(){},updateCallback:function(e){var t=g.filter((function(t){return t.categoryId===e}))[0].name;i({title:"Edit category",explanation:"Type the category name",defaultText:t,onDoneCallback:function(t){ge.Categories.updateCategory([{name:t,categoryId:e}]).then((function(){l(!0,"Category updated successfully"),b((function(a){return a.map((function(a){return a.categoryId===e?Object(p.a)(Object(p.a)({},a),{},{name:t}):a}))}))})).catch((function(){l(!1,"Failed to update category.")}))},validateInput:function(e){return e.length>0?0:1},textFieldLabel:"Restaurants, hiking, etc..."})},removeCallback:function(e){var t=g.filter((function(t){return t.categoryId===e}))[0].name;a("Warning","Are you sure you want the category, named '"+t+"'?",[{name:"yes",action:function(){u((function(e){return Object(p.a)(Object(p.a)({},e),{},{categories:!0})})),ge.Categories.removeCategory([{categoryId:e}]).then((function(){l(!0,"Category successfully removed."),b((function(t){return t.filter((function(t){return t.categoryId!==e}))}))})).catch((function(){l(!1,"An error has occurred while removing category.")})).finally((function(){u((function(e){return Object(p.a)(Object(p.a)({},e),{},{categories:!1})}))}))}}],(function(){}))},id:"categoryId",isLoading:s.categories}),r.a.createElement(ve.a,{className:t.buttonWrapper},r.a.createElement(be.a,{variant:"text",color:"secondary",size:"large",onClick:function(){i({title:"Add category",explanation:"Type the category name",onDoneCallback:function(e){ge.Categories.addCategory([{name:e}]).then((function(t){l(!0,"Category inserted successfully"),b((function(a){return[].concat(Object(Ae.a)(a),[{name:e,categoryId:t[0]}])}))})).catch((function(e){l(!1,"Failed to add category.")}))},validateInput:function(e){return e.length>0?0:1},textFieldLabel:"Restaurants, hiking, etc..."})},startIcon:r.a.createElement(Ee.a,null)},"Add a new category")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(ae,{title:"Abstracted categories",headCells:lr,data:v,pagingInfo:null,checkable:!1,searchFunction:P,changePageCallback:function(){},updateCallback:function(e){var t=v.filter((function(t){return t.categoryId===e}))[0];i({title:"Edit abstraction category",explanation:"Type the abstraction category name",defaultText:t.name,onDoneCallback:function(a,n){ge.Categories.updateAbstractedCategories({name:n,categoryId:t.categoryId,mappedCategories:a}).then((function(){l(!0,"Abstraction category updated successfully"),y((function(t){return t.map((function(t){return t.categoryId===e?Object(p.a)(Object(p.a)({},t),{},{name:n,mappedCategories:a,count:a.length,label:a.map((function(e){return e.name})).join(" | ")}):t}))}))})).catch((function(){l(!1,"Failed to update abstraction category.")}))},validateInput:function(e){return console.log("Input length",e),e.length>0?0:1},textFieldLabel:"Restaurants, hiking, etc...",payload:{type:"SUPER_CAT",options:g,selectedOptions:t.mappedCategories}})},removeCallback:function(){},id:"categoryId",isLoading:s.categories}),r.a.createElement("br",null),r.a.createElement(ae,{title:"Tags",headCells:ir,data:C,pagingInfo:null,checkable:!1,searchFunction:P,changePageCallback:function(){},updateCallback:function(e){var t=C.filter((function(t){return t.tagId===e}))[0].name;i({title:"Edit tag",explanation:"Type the tag name",defaultText:t,onDoneCallback:function(t){ge.Tags.updateTags([{name:t,tagId:e}]).then((function(){l(!0,"Tag updated successfully"),S((function(a){return a.map((function(a){return a.tagId===e?Object(p.a)(Object(p.a)({},a),{},{name:t}):a}))}))})).catch((function(){l(!1,"Failed to update tag.")}))},validateInput:function(e){return e.length>0?0:1},textFieldLabel:"Warm, quick, cozy..."})},removeCallback:function(e){var t=C.filter((function(t){return t.tagId===e}))[0].name;a("Warning","Are you sure you want the tag, named '"+t+"'?",[{name:"yes",action:function(){u((function(e){return Object(p.a)(Object(p.a)({},e),{},{tags:!0})})),ge.Tags.removeTags([{tagId:e}]).then((function(){l(!0,"Tag successfully removed."),S((function(t){return t.filter((function(t){return t.tagId!==e}))}))})).catch((function(){l(!1,"An error has occurred while removing tag.")})).finally((function(){u((function(e){return Object(p.a)(Object(p.a)({},e),{},{tags:!1})}))}))}}],(function(){}))},customToolbarElements:r.a.createElement("div",null,r.a.createElement(Re,{options:C,setOptions:S,selectedOptions:x,setSelectedOptions:w,id:"tagId",label:"Select featured tags"}),r.a.createElement(Mt.a,{severity:"error"},"Please, bare in mind that there shouldn't be more than ~8 featured tags. These selections directly influence search results in Travelgo app."),r.a.createElement(be.a,{style:{alignSelf:"flex-end",marginBottom:32,marginTop:16},onClick:function(){ge.Tags.updateFeaturedTags(x).then((function(){l(!0,"Featured tags updated and now live!")})).catch((function(){l(!1,"Error updating featured tags")}))},variant:"contained",color:"primary"},"Save featured tags")),id:"tagId",isLoading:s.tags}),r.a.createElement(ve.a,{className:t.buttonWrapper},r.a.createElement(be.a,{variant:"text",color:"secondary",size:"large",onClick:function(){i({title:"Add tag",explanation:"Type the tag name",onDoneCallback:function(e){ge.Tags.addTag([{name:e}]).then((function(t){l(!0,"Tag inserted successfully"),S((function(a){return[].concat(Object(Ae.a)(a),[{name:e,tagId:t[0]}])}))})).catch((function(){l(!1,"Failed to add tag.")}))},validateInput:function(e){return e.length>0?0:1},textFieldLabel:"Warm, quick, cozy..."})},startIcon:r.a.createElement(Ee.a,null)},"Add a new tag"))))})),cr=function(e){var t=e.open,a=e.setOpen,l=e.userData,i=e.availableRoles,o=e.setAvailableRoles,c=Object(n.useState)([]),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Ie().addConfig,f=je().addAlertConfig;Object(n.useEffect)((function(){d(l.roles)}),[l.roles]);return r.a.createElement(ot.a,{open:t,fullWidth:!0,maxWidth:"lg",onClose:function(){a(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(st.a,{id:"alert-dialog-title"},"Update user - ",l.name+" "+l.surname),r.a.createElement(ut.a,null,r.a.createElement(j.a,{variant:"h6"},"Change user permissions"),r.a.createElement(Re,{id:"roleId",name:"role",label:"Select sources",options:i,setOptions:o,setSelectedOptions:d,selectedOptions:u}),u.map((function(e){return r.a.createElement("div",null,r.a.createElement("b",null,e.role)," - ",e.description,r.a.createElement("br",null))}))),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return a(!1)},color:"primary"},"Close"),r.a.createElement(be.a,{onClick:function(){f("Update user","Are you sure you want to update this user's permissions?",[{name:"Yes",action:function(){var e=[];u.map((function(t){e.push(t.roleId)})),ge.User.setRoles({userId:l.id,roles:e}).then((function(e){p(!0,"Updated user successfully"),a(!1)})).catch((function(e){p(!1,"Could not update user")}))}}])},color:"primary"},"Update user")))},sr=a(735);a(369);var ur=Me()((function(e){return{root:{margin:e.spacing(2),display:"flex",flexDirection:"column"},textField:{marginTop:16},formControl:{margin:e.spacing(1),minWidth:120}}}))((function(e){var t=e.classes,a=e.open,l=e.setOpen,i=e.availableRoles,o=Ie().addConfig,c=je().addAlertConfig,s=Object(n.useState)({name:"",surname:"",password:"",email:"",role:-1}),u=Object(m.a)(s,2),d=u[0],p=u[1],f=Object(n.useState)({name:!1,surname:!1,password:!1,email:!1,role:!1}),g=Object(m.a)(f,2),b=g[0],h=g[1],E=Object(n.useState)(!1),v=Object(m.a)(E,2),y=v[0],O=v[1],S=function(e){var t=e.target,a=t.name,n=t.value,r=Object.assign({},d);r[a]=n,p(r)};function k(){var e;(function(){var e=Object.assign({},b),t=!1;for(var a in d)e[a]=""===d[a]||-1===d[a],!0===e[a]&&(t=!0);return h(e),t})()||c("Add new editor","Are you sure you want to add new editor?. This user has role: "+(e=d.role,i.map((function(t){if(t.roleId===e)return t.role+" - "+t.description}))),[{name:"Yes",action:function(){O(!0),ge.Auth.register(d).then((function(e){ge.User.setRoles({userId:e,roles:[d.role]}).then((function(e){o(!0,"User was added successfully!"),l(!1),O(!1)})).catch((function(e){l(!1),o(!1,"Could not map user permissions!"),O(!1)}))})).catch((function(e){o(!1,e.message),O(!1)}))}}])}return r.a.createElement(ot.a,{open:a,fullWidth:!0,maxWidth:"md",onClose:function(){l(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},y?r.a.createElement(Z.a,null):null,r.a.createElement(st.a,{id:"alert-dialog-title"},"Add new editor"),r.a.createElement(ut.a,null,r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{id:"outlined-basic",error:b.name,required:!0,label:"Name",name:"name",value:d.name,onChange:S,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,error:b.surname,label:"Surname",name:"surname",value:d.surname,onChange:S,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,error:b.email,label:"Email",name:"email",value:d.email,onChange:S,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,error:b.password,autoComplete:"new-password",label:"Password",name:"password",value:d.password,onChange:S,variant:"outlined",type:"password",className:t.textField}),r.a.createElement("br",null),r.a.createElement(Mt.a,{severity:"info"},"Make sure to use secure password as it will give access to modify data in admin panel.",r.a.createElement("br",null),"*Password must contain between 8 and 30 characters",r.a.createElement("br",null),"*Password must have atleast one digit",r.a.createElement("br",null),"*Password must have atleast one upper character"),r.a.createElement(C.a,{className:t.textField,medium:!0}),r.a.createElement(rt.a,{error:b.role,variant:"outlined",className:t.textField},r.a.createElement(lt.a,null,"User role"),r.a.createElement(it.a,{onChange:function(e,t){var a=Object.assign({},d);a.role=t.props.value,p(a)},value:d.role,label:"Select user role"},r.a.createElement("option",{value:"-1"},"None"),i.map((function(e){return r.a.createElement("option",{value:e.roleId}," ",e.role)}))),r.a.createElement(sr.a,null,"Select one of the available user roles")),1===d.role?r.a.createElement(Mt.a,{className:t.textField,severity:"warning"},"ROLE_ADMIN will have full access to the system. Make sure you know this person!"):null,r.a.createElement(j.a,{variant:"h6",style:{marginTop:48}},"Available roles"),r.a.createElement("div",{className:t.textField},i.map((function(e){return r.a.createElement(j.a,{variant:"subtitle1",gutterBottom:!0},e.role," - ",e.description)}))))),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return l(!1)},color:"primary"},"Close"),r.a.createElement(be.a,{color:"primary",onClick:function(){k()}},"Add user")))})),dr=[{id:"name",numeric:!1,disablePadding:!1,label:"Name",isId:!0},{id:"surname",numeric:!1,disablePadding:!1,label:"Surname",isId:!1},{id:"email",numeric:!1,disablePadding:!1,label:"Contact email",isId:!1},{id:"phoneNumber",numeric:!1,disablePadding:!1,label:"Phone number",isId:!1},{id:"parsedRoles",numeric:!1,disablePadding:!1,label:"Roles",isId:!1},{id:"actions",numeric:!1,disablePadding:!1,label:"Actions",isId:!1}];var mr=Object(L.a)((function(e){var t;return{button:{margin:e.spacing(2)},input:{display:"none"},root:{height:"100vh",width:"100%",overflow:"auto"},buttonsDiv:{backgroundColor:"red",justifyContent:"flex-end"},content:(t={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Object(d.a)(t,e.breakpoints.down("lg"),{padding:e.spacing(1)}),Object(d.a)(t,e.breakpoints.up("lg"),{padding:e.spacing(8)}),t),autocomplete:{width:"200px",height:"40px",fontSize:"14px",border:"0",borderBottom:"2px solid grey",outline:"0",marginBottom:"4px"}}}))((function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),l=a[0],i=a[1],o=Object(n.useState)({}),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)([]),p=Object(m.a)(d,2),f=p[0],g=p[1],b=Object(n.useState)([]),h=Object(m.a)(b,2),E=h[0],v=h[1],y=Object(n.useState)(!0),O=Object(m.a)(y,2),j=O[0],C=O[1],S=e.classes,k=Object(n.useState)(!1),I=Object(m.a)(k,2),x=I[0],w=I[1],P=Object(n.useState)(!1),T=Object(m.a)(P,2),A=T[0],D=T[1],N=(je().addAlertConfig,Ie().addConfig);function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";M("?p="+e+"&s=10&keyword="+t)}function L(e){C(!1);var t=[];e.list.map((function(e){var a=[];e.roles.map((function(e){a.push(e.role)})),e.parsedRoles=a.join(","),t.push(e)})),delete e.list,i(t),console.log(t),v(e)}return Object(n.useEffect)((function(){ge.User.getAllRoles().then((function(e){console.log(e),g(e)})).catch((function(e){N(!1,e.message)}))}),[]),r.a.createElement("div",{className:S.root},r.a.createElement("div",{className:S.content},x?r.a.createElement(cr,{open:x,setOpen:w,availableRoles:f,setAvailableRoles:g,userData:s}):null,A?r.a.createElement(ur,{open:A,availableRoles:f,setOpen:D}):null,r.a.createElement(ae,{title:"Users",headCells:dr,data:l,pagingInfo:E,checkable:!1,changePageCallback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";C(!0),R(e,t)},updateCallback:function(e){l.map((function(t){t.id===e&&u(t)})),w(!0)},id:"id",isLoading:j}),r.a.createElement(ve.a,{display:"flex",justifyContent:"flex-end"},r.a.createElement(be.a,{onClick:function(){D(!0)},variant:"text",color:"secondary",size:"large",className:S.button,startIcon:r.a.createElement(Ee.a,null)},"Add user"))),r.a.createElement(be.a,null,"Clear filters"));function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ge.User.getAllUsers(e).then((function(e){console.log(e),C(!1),L(e)})).catch((function(e){C(!1),console.log(e)}))}})),pr=r.a.createContext(),fr=function(e){var t=e.children,a=Object(n.useState)(null),l=Object(m.a)(a,2),i=l[0],o=l[1],c=Object(n.useState)(!0),s=Object(m.a)(c,2),u=s[0],d=s[1];return Object(n.useEffect)((function(){var e=de();""!==e&&void 0!==e?ge.User.getUserProfile().then((function(e){o(e),d(!1)})).catch((function(e){console.log(e),d(!1)})):console.log("Refresh token is empty. No actions taken.")}),[]),r.a.createElement(pr.Provider,{value:{currentUser:i,setCurrentUser:o,isLoading:u}},t)},gr=a(276),br=r.a.createContext();function hr(e){var t=e.children,a=Object(n.useState)({open:!1,currentlyEditing:void 0,rootList:[],setRootList:function(){}}),l=Object(m.a)(a,2),i=l[0],o=l[1];return r.a.createElement(br.Provider,{value:{config:i,startEditing:function(e,t,a){var n=Object(p.a)({},i);n.open=!0,n.currentlyEditing=e,n.rootList=t,n.setRootList=a,o(n)},finishEditing:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=Object(p.a)({},i);if(a.open=!1,void 0!==t)for(var n=0;n<a.currentlyEditing.objects.length;n++)a.currentlyEditing.objects[n].id===t&&a.currentlyEditing.objects.splice(n,1);if(e){for(var r=Object(Ae.a)(i.rootList),l=0;l<r.length;l++)if(r[l].id===a.currentlyEditing.id){r[l]=a.currentlyEditing;break}i.setRootList(r)}o(a)},removeRecommendation:function(){var e=Object(p.a)({},i);e.open=!1;for(var t=Object(Ae.a)(e.rootList),a=0;a<t.length;a++)console.log(t[a].id),t[a].id===e.currentlyEditing.id&&t.splice(a,1);i.setRootList(t),o(e)},setRecommendation:function(e){var t=Object(p.a)({},i);t.currentlyEditing=e,o(t)}}},t)}var Er=Object(pt.b)((function(e){var t=e.classes,a=e.place,n=e.removeObjectFromRecommendation;return r.a.createElement("div",{className:t.recommendedPlaceCard},r.a.createElement(_a,{placeData:a,renderActionArea:function(){return r.a.createElement("div",null,r.a.createElement(S.a,{"aria-label":"delete",onClick:function(){return n(a.id)}},r.a.createElement(V.a,{color:"secondary",fontSize:"small"})))}}))})),vr=Object(pt.a)((function(e){var t=e.classes,a=e.config,n=e.removeObjectFromRecommendation;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},a.currentlyEditing.objects.length>0?a.currentlyEditing.objects.map((function(e,a){return delete e.description,r.a.createElement(Er,{classes:t,removeObjectFromRecommendation:n,key:e.id,index:a,place:e})})):r.a.createElement(Mt.a,{severity:"info"},"This recommendation does not have any objects attached. You can attach Places or Tours by browsing in Places and Tours tables"))}));var yr=Me()((function(e){return{root:{margin:e.spacing(2),display:"flex",flexDirection:"column"},textField:{marginTop:16},formControl:{margin:e.spacing(1),minWidth:120},recommendedPlaceCard:{width:300,height:300,padding:16,display:"flex",flexDirection:"column",alignContent:"flex-end",zIndex:999999}}}))((function(e){var t=e.classes,a=Ie().addConfig,l=je().addAlertConfig,i=Object(n.useContext)(br),o=i.config,c=i.setRecommendation,s=i.finishEditing,u=i.removeRecommendation,d=Object(n.useState)(!1),f=Object(m.a)(d,2),g=f[0],b=f[1],h=function(e){var t=e.target,a=t.name,n=t.value,r=Object(p.a)({},o.currentlyEditing);r[a]=n,c(r)};function E(){l("Edit recommendation","Are you sure you want to edit this recommendation?",[{name:"Yes",action:function(){b(!0);var e=function(){var e=Object(p.a)({},o.currentlyEditing),t=[];return o.currentlyEditing.objects.map((function(a){t.push({id:a.id,type:e.type})})),e.objects=t,e}();ge.Recommendation.updateRecommendation(e).then((function(){a(!0,"Updated recommendation successfuly"),s(!0)})).catch((function(){a(!1,"Something went wrong. Please try again!")})).finally((function(){b(!1)}))}}])}return r.a.createElement(ot.a,{open:o.open,fullWidth:!0,maxWidth:"md",onClose:function(){s()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},g?r.a.createElement(Z.a,null):null,r.a.createElement(st.a,{id:"alert-dialog-title"},"Edit recommendation"),r.a.createElement(ut.a,null,void 0!==o.currentlyEditing?r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{id:"outlined-basic",required:!0,label:"Title",name:"name",value:o.currentlyEditing.name,onChange:h,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,label:"Subtitle",name:"subtitle",value:o.currentlyEditing.subtitle,onChange:h,variant:"outlined",className:t.textField}),r.a.createElement(J.a,{id:"outlined-basic",required:!0,label:"Description",name:"description",value:o.currentlyEditing.description,onChange:h,variant:"outlined",className:t.textField}),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",overflowX:"auto",width:"100%"}},r.a.createElement(vr,{removeObjectFromRecommendation:function(e){l("Remove object from recommendation","Are you sure you want to remove this object from recommendation?",[{name:"Yes",action:function(){b(!0),ge.Recommendation.removePlaceFromRecommendation({id:e,recommendationId:o.currentlyEditing.id,type:o.currentlyEditing.type}).then((function(){a(!0,"Object removed from recommendation"),s(!0,e)})).catch((function(){a(!1,"Something went wrong!")})).finally((function(){b(!1)}))}}])},classes:t,config:o,axis:"xy",pressDelay:200,disableAutoscroll:!1,onSortEnd:function(e){var t=e.oldIndex,a=e.newIndex;console.log("OnSortEnd");var n=Object(p.a)({},o.currentlyEditing);n.objects=Object(pt.c)(n.objects,t,a),c(n)}}))):null),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){return s()},color:"primary"},"Close"),r.a.createElement(be.a,{color:"primary",onClick:function(){E()}},"Save"),r.a.createElement(be.a,{variant:"contained",color:"secondary",onClick:function(){l("Remove recommendation","Are you sure you want to remove this recommendation?",[{name:"Yes",action:function(){b(!0),ge.Recommendation.removeRecommendation(o.currentlyEditing.id).then((function(){a(!0,"Removed recommendation successfully"),u()})).catch((function(){a(!1,"Something went wrong. Please try again!")})).finally((function(){b(!1)}))}}])}},"Delete recommendation")))})),Or=a(806);var jr=Object(L.a)((function(e){return{root:{flexWrap:"wrap",display:"flex",flexDirection:"row",flex:1,justifyContent:"center",alignContent:"center",width:"100%",height:"100%"},left:{width:"50%",height:"100%",padding:16},leftTop:{alignItems:"flex-start",height:"10%",display:"flex",flexDirection:"column"},leftContent:{padding:16,borderStyle:"dashed",height:"80%",overflowY:"auto",display:"flex",alignItems:"center",flexDirection:"column"},right:{width:"50%",height:"100%",padding:16},rightTop:{alignItems:"flex-start",height:"10%",display:"flex",flexDirection:"column"},rightContent:{padding:16,borderStyle:"dashed",height:"80%",overflowY:"auto",display:"flex",alignItems:"center",flexDirection:"column"}}}))((function(e){var t=e.classes,a=Object(n.useState)([]),l=Object(m.a)(a,2),i=l[0],o=l[1],c=Object(n.useState)([]),s=Object(m.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(""),f=Object(m.a)(p,2),g=f[0],b=f[1],h=Object(n.useState)(!0),E=Object(m.a)(h,2),v=E[0],y=E[1],O=Object(n.useState)({pageNum:1}),C=Object(m.a)(O,2),S=C[0],k=C[1],I=Object(n.useContext)(br).startEditing,x=Ie().addConfig;function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ge.Recommendation.getAllRecommendations("?full=true&p="+e+"&keyword="+g).then((function(e){o(t?P(e.list,u):function(t){return[].concat(Object(Ae.a)(t),Object(Ae.a)(P(e.list,u)))}),delete e.list,k(e)})).catch((function(){})).finally((function(){y(!1)}))}function P(e,t){for(var a=[],n=!1,r=0;r<e.length;r++){for(var l=0;l<t.length;l++)if(e[r].id===t[l].id){n=!0;break}n||a.push(e[r]),n=!1}return a}Object(n.useEffect)((function(){y(!0),Promise.all([ge.Explore.getExplorePage("?s=100"),ge.Recommendation.getAllRecommendations("?full=true")]).then((function(e){d(e[0].list),o(P(e[1].list,e[0].list))})).catch((function(){})).finally((function(){y(!1)}))}),[]),Object(n.useEffect)((function(){v||w(1,!0)}),[g]);var T=ga()((function(e){return function(e){console.log("Handle scroll");Math.round(e.target.scrollHeight-e.target.scrollTop-0)<=e.target.clientHeight&&!v&&i.length>0&&S.pageNum<S.pages&&(y(!0),console.log("Requesting new page"),w(S.pageNum+1))}(e)}),200);function A(){return r.a.createElement("div",null,r.a.createElement(Or.a,{animation:"wave",variant:"rect",width:200,height:40}),r.a.createElement(Or.a,{animation:"wave",variant:"text",width:180}),r.a.createElement(Or.a,{animation:"wave",variant:"text",width:250}),r.a.createElement("div",{style:{display:"flex",margin:16,flexDirection:"row"}},r.a.createElement(Or.a,{animation:"wave",variant:"rect",style:{marginRight:16},width:300,height:300}),r.a.createElement(Or.a,{animation:"wave",variant:"rect",style:{marginRight:16},width:300,height:300}),r.a.createElement(Or.a,{animation:"wave",variant:"rect",style:{marginRight:16},width:300,height:300})),r.a.createElement(Or.a,{animation:"wave",variant:"text",width:1e3}))}return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.left},r.a.createElement("div",{className:t.leftTop},r.a.createElement(j.a,{variant:"h4"},"Home recommendations"),r.a.createElement(be.a,{onClick:function(){var e=[];u.map((function(t){e.push(t.id)})),ge.Explore.updateExplorePage(e).then((function(){x(!0,"Updated explore page successfully!")})).catch((function(){x(!1,"Unexpected error!")})).finally((function(){}))},variant:"contained",color:"primary"},"Save feed")),r.a.createElement("div",{className:t.leftContent},v?r.a.createElement(r.a.Fragment,null,r.a.createElement(A,null),r.a.createElement(A,{style:{marginTop:48}})):u.length>0?r.a.createElement(gr.a,{style:{width:"100%",height:"100%"},list:u,setList:d,animation:150,group:"cards",onChange:function(e,t,a){},onEnd:function(e){}},u.map((function(e){return r.a.createElement(qa,{key:e.id,recommendation:e,onEditCallback:function(){I(e,u,d)}})}))):r.a.createElement(Mt.a,{style:{marginTop:48},severity:"info"},"No recommendations are put in home tab. Click and Drag existing recommendations from right side."))),r.a.createElement("div",{className:t.right},r.a.createElement("div",{className:t.rightTop},r.a.createElement(j.a,{variant:"h4"},"Existing recommendations")),r.a.createElement("div",{className:t.rightContent,onScroll:function(e){e.persist(),T(e)}},r.a.createElement(J.a,{id:"standard-search",label:"Search",value:g,type:"search",onChange:function(e){b(e.target.value)}}),v?r.a.createElement(r.a.Fragment,null,r.a.createElement(A,null),r.a.createElement(A,{style:{marginTop:16}})):i.length>0?r.a.createElement(gr.a,{style:{width:"100%",height:"100%"},list:i,setList:o,animation:150,group:"cards",onChange:function(e,t,a){},onEnd:function(e){}},i.map((function(e){return r.a.createElement(qa,{onEditCallback:function(){I(e,i,o)},key:e.id,recommendation:e})}))):r.a.createElement(Mt.a,{style:{marginTop:48},severity:"info"},"Currently there are no available recommendations."))),r.a.createElement(yr,null))})),Cr=Object(g.a)((function(e){return{root1:{overflow:"hidden",display:"flex",height:"100vh",background:"#F1F1F1"},appBar:{height:"64px",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(p.a)(Object(p.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{width:"100vw",height:"100%",marginLeft:-240},contentShift:{width:"100vw",height:"100%",marginLeft:0}}})),Sr=function(e){return r.a.createElement($e,null,r.a.createElement(tr,e))},kr=function(e){return r.a.createElement(hr,null,r.a.createElement(jr,e))};function Ir(e){var t=Cr(),a=Object(b.a)(),l=Object(n.useState)(!1),i=Object(m.a)(l,2),o=i[0],c=i[1],s=ka(),u=s.title,p=s.setTitle,g=je().addAlertConfig,k=Object(R.g)(),x=Object(n.useContext)(pr).currentUser,P=function(){c(!1)},L=function(e,t){P(),p(t),new RegExp(e+"([0-9]*)?").test(k.pathname)&&(se.push(e),se.go(0))};var _=function(e){return null!=x&&x.permissions.some((function(t){return t.permission===e}))};return r.a.createElement("div",{className:t.root1},r.a.createElement(E.a,null),r.a.createElement(v.a,{position:"fixed",className:Object(f.a)(t.appBar,Object(d.a)({},t.appBarShift,o))},r.a.createElement(y.a,null,r.a.createElement(S.a,{color:"inherit","aria-label":"open drawer",onClick:function(){c(!0)},edge:"start",className:Object(f.a)(t.menuButton,o&&t.hide)},r.a.createElement(I.a,null)),r.a.createElement(j.a,{variant:"h6",noWrap:!0},u))),r.a.createElement(h.a,{className:t.drawer,variant:"persistent",anchor:"left",open:o,classes:{paper:t.drawerPaper}},r.a.createElement("div",{className:t.drawerHeader},r.a.createElement(j.a,{variant:"h6",style:{width:"100%"}},null!=x?x.name:"Loading user profile"),r.a.createElement(S.a,{onClick:P},"ltr"===a.direction?r.a.createElement(w.a,null):r.a.createElement(T.a,null))),r.a.createElement(C.a,null),r.a.createElement(O.a,null,r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/home",onClick:function(){return L("/app/home","Home")}},r.a.createElement(D.a,null,"Home")),r.a.createElement(C.a,{light:!0}),r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/places",onClick:function(){return L("/app/places","Places")}},r.a.createElement(D.a,null,"Places")),r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/tours",onClick:function(){return L("/app/tours","Tours")}},r.a.createElement(D.a,null,"Tours")),r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/recommendations",onClick:function(){return L("/app/recommendations","Recommendations")}},r.a.createElement(D.a,null,"Recommendations")),_("place:insert")&&r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/addplace",onClick:function(){return L("/app/addplace","Add Place")}},r.a.createElement(D.a,null,"Add place")),_("tour:modify")&&r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/addtour",onClick:function(){return L("/app/addtour","Add tour")}},r.a.createElement(D.a,null,"Add tour")),r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/resources",onClick:function(){return L("/app/resources","Manage resources")}},r.a.createElement(D.a,null,"Resources")),_("role:manage")&&r.a.createElement(A.a,{button:!0,component:N.a,to:"/app/users",onClick:function(){return L("/app/users","Manage users")}},r.a.createElement(D.a,null,"Manage users")),r.a.createElement(C.a,{light:!0}),r.a.createElement(A.a,{button:!0,onClick:function(){g("Logout","Are you sure you want to logout",[{name:"Yes",action:function(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),se.push("/login")}}])}},r.a.createElement(D.a,null,"Logout")))),r.a.createElement("main",{className:Object(f.a)(t.content,Object(d.a)({},t.contentShift,o))},r.a.createElement("div",{className:t.drawerHeader}),r.a.createElement(R.d,null,r.a.createElement(R.b,{exact:!0,path:"/app/home",component:M}),r.a.createElement(R.b,{path:"/app/places",component:Xe}),r.a.createElement(R.b,{path:"/app/tours",component:nr}),r.a.createElement(R.b,{path:"/app/addplace/:placeId?",component:en}),r.a.createElement(R.b,{path:"/app/recommendations",component:kr}),r.a.createElement(R.b,{path:"/app/addtour/:tourId?",component:Sr}),r.a.createElement(R.b,{path:"/app/resources",component:or}),r.a.createElement(R.b,{path:"/app/users",component:mr}),r.a.createElement(tn.a,{from:"*",to:"/404"}))))}var xr=a(41),wr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(xr.a,{utils:He.a},r.a.createElement(Sa,null,r.a.createElement(Ir,null))))}}]),a}(n.Component),Pr=a(410),Tr=a.n(Pr),Ar=a(809);function Dr(){return r.a.createElement(j.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ","Traveldirection "," ",(new Date).getFullYear(),".")}var Nr=Object(g.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},loaderMain:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",backgroundColor:"red"}}}));var Rr=a(415),Lr=a(411),Mr=function(e){var t=e.component,a=Object(Rr.a)(e,["component"]);return r.a.createElement(Lr.a,Object.assign({},a,{render:function(e){return!0===me()?r.a.createElement(t,e):r.a.createElement(tn.a,{to:"/login"})}}))};function _r(){return r.a.createElement(j.a,{variant:"body2",color:"textSecondary"},"Copyright \xa9 ","Traveldirection "," ",(new Date).getFullYear(),".")}var Fr=Object(g.a)((function(e){return{root:{display:"flex",flexDirection:"column",minHeight:"100vh"},main:{marginTop:e.spacing(8),marginBottom:e.spacing(2)},footer:{padding:e.spacing(3,2),marginTop:"auto",backgroundColor:"light"===e.palette.type?e.palette.grey[200]:e.palette.grey[800]}}}));var Hr=a(818);function qr(e){var t=Ie(),a=t.config,n=t.removeConfig;return r.a.createElement(Hr.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!!a,autoHideDuration:4e3,onClose:n},r.a.createElement(Mt.a,{onClose:n,severity:a?a.success?"success":"error":""},!!a&&a.message))}var Wr=a(810),Br=function(){var e=je(),t=e.alertConfig,a=e.removeAlertConfig;function n(){void 0!==t.onClose&&t.onClose(),a()}return r.a.createElement(ot.a,{open:!!t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(st.a,{id:"alert-dialog-title"},t?t.title:""),r.a.createElement(ut.a,null,r.a.createElement(Wr.a,{id:"alert-dialog-description"},t?t.message:"")),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:n,color:"primary"},"Close"),!!t&&t.actions.map((function(e){return r.a.createElement(be.a,{onClick:function(){n(),e.action()},color:"primary"},e.name)}))))},Ur=function(){var e=ra(),t=e.dialogConfig,a=(e.removeEditDialogConfig,e.dialogOpen),l=e.setDialogOpen,i=Object(n.useState)(""),o=Object(m.a)(i,2),c=o[0],s=o[1],u=Object(n.useState)(0),d=Object(m.a)(u,2),p=d[0],f=d[1],g=function(){f(0),l(!1),s("")};return r.a.createElement("div",null,r.a.createElement(ot.a,{open:a,"aria-labelledby":"form-dialog-title",fullWidth:!0},r.a.createElement(st.a,{id:"form-dialog-title"},t.title),r.a.createElement(ut.a,null,r.a.createElement(Wr.a,null,t.explanation),r.a.createElement(J.a,{autoFocus:!0,helperText:0!==p&&null!==t.errorMessages[p]?t.errorMessages[p]:"",error:0!==p,margin:"dense",id:"name",onInput:function(e){s(e.target.value)},label:t.textFieldLabel,defaultValue:t.defaultText,type:"email",fullWidth:!0})),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){g()},color:"primary"},"Cancel"),r.a.createElement(be.a,{onClick:function(){var e=t.validateInput(c);f(e),0===e&&(void 0!==t.onDoneCallback&&t.onDoneCallback(c),g())},color:"primary"},"Done"))))};var zr=function(){var e=ra(),t=e.dialogConfig,a=(e.removeEditDialogConfig,e.dialogOpen),l=e.setDialogOpen,i=Object(n.useState)(""),o=Object(m.a)(i,2),c=o[0],s=o[1],u=Object(n.useState)(0),d=Object(m.a)(u,2),p=d[0],f=d[1],g=Object(n.useState)(),b=Object(m.a)(g,2),h=b[0],E=b[1],v=Object(n.useState)(),y=Object(m.a)(v,2),O=y[0],j=y[1],C=function(){f(0),l(!1),s("")};Object(n.useEffect)((function(){"SUPER_CAT"===t.payload.type&&(s(t.defaultText),ge.Categories.abstractedCategoriesLeftOver().then((function(e){console.log("Opcionais",e),E(e)})).catch((function(e){})).finally((function(){})),j(t.payload.selectedOptions))}),[t.payload]);return r.a.createElement("div",null,r.a.createElement(ot.a,{open:a,"aria-labelledby":"form-dialog-title",fullWidth:!0},r.a.createElement(st.a,{id:"form-dialog-title"},t.title),r.a.createElement(ut.a,null,r.a.createElement(Wr.a,null,t.explanation),r.a.createElement(J.a,{autoFocus:!0,helperText:0!==p&&null!==t.errorMessages[p]?t.errorMessages[p]:"",error:0!==p,margin:"dense",id:"name",onInput:function(e){s(e.target.value)},label:t.textFieldLabel,defaultValue:t.defaultText,type:"email",fullWidth:!0}),r.a.createElement("br",null),r.a.createElement("br",null),h&&O&&r.a.createElement(Re,{label:"Select categories to include in abstraction",id:"categoryId",options:h,setOptions:E,selectedOptions:O,setSelectedOptions:j})),r.a.createElement(ct.a,null,r.a.createElement(be.a,{onClick:function(){C()},color:"primary"},"Cancel"),r.a.createElement(be.a,{onClick:function(){var e=t.validateInput(c);console.log("Error",e),f(e),0===e&&(void 0!==t.onDoneCallback&&t.onDoneCallback(O,c),C())},color:"primary"},"Done"))))};a(369).config(),i.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,null,r.a.createElement(fr,null,r.a.createElement(R.c,{history:se},r.a.createElement(Ge,null,r.a.createElement(ke,null,r.a.createElement(Oe,null,r.a.createElement(na,null,r.a.createElement(qr,null),r.a.createElement(Br,null),r.a.createElement(Ur,null),r.a.createElement(zr,null),r.a.createElement($e,null,r.a.createElement(R.d,null,r.a.createElement(tn.a,{exact:!0,from:"/",to:"/login"}),r.a.createElement(tn.a,{exact:!0,from:"/app",to:"/app/home"}),r.a.createElement(Mr,{path:"/app",component:wr}),r.a.createElement(R.b,{path:"/login",component:function(){var e=Nr(),t=Object(n.useState)(""),a=Object(m.a)(t,2),l=a[0],i=a[1],o=Object(n.useState)(""),c=Object(m.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)(!1),p=Object(m.a)(d,2),f=p[0],g=p[1],b=Ie().addConfig,h=Object(n.useContext)(pr),v=(h.currentUser,h.setCurrentUser),y=function(){g(!0),console.log("handleLogin",{identifier:l,password:s}),ge.Auth.login({identifier:l,password:s}).then((function(e){if(!function(e){var t=!1;return e.map((function(e){console.log(e),"ROLE_ADMIN"===e.authority&&(t=!0)})),t}(e.authorities))return b(!1,"Only admins and editors can access admin panel!"),void g(!1);g(!1),localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),ge.User.getUserProfile().then((function(e){console.log("User profile:",e),v(e),se.push("/app/home")})).catch((function(e){g(!1),b(!1,e.message)}))})).catch((function(e){g(!1),b(!1,e.message)}))};return me()?r.a.createElement(tn.a,{to:"/app"}):r.a.createElement(Ar.a,{component:"main",maxWidth:"xs",onKeyPress:function(e){return 13!==(t=e).which&&13!==t.keyCode||(y(),!1);var t}},f&&r.a.createElement(Z.a,null),r.a.createElement(E.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(zt.a,{className:e.avatar},r.a.createElement(Tr.a,null)),r.a.createElement(j.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement(J.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,value:l,onChange:function(e){i(e.target.value)},id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0}),r.a.createElement(J.a,{variant:"outlined",margin:"normal",required:!0,value:s,onChange:function(e){u(e.target.value)},fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password"}),r.a.createElement(be.a,{onClick:function(){y()},fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Sign In")),r.a.createElement(ve.a,{mt:8},r.a.createElement(Dr,null)))}}),r.a.createElement(R.b,{path:"*",component:function(){var e=Fr();return r.a.createElement("div",{className:e.root},r.a.createElement(E.a,null),r.a.createElement(Ar.a,{component:"main",className:e.main,maxWidth:"sm"},r.a.createElement(j.a,{variant:"h2",component:"h1",gutterBottom:!0},"Page not found"),r.a.createElement(j.a,{variant:"h5",component:"h2",gutterBottom:!0},"Try something else")),r.a.createElement("footer",{className:e.footer},r.a.createElement(Ar.a,{maxWidth:"sm"},r.a.createElement(_r,null))))}}),r.a.createElement(tn.a,{from:"*",to:"/404"}))))))))))),document.getElementById("root"))}},[[442,1,2]]]);
//# sourceMappingURL=main.6abf61f6.chunk.js.map